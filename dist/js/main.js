!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=119)}([function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(37))},function(t,e,n){var i=n(0),s=n(42),r=n(4),o=n(43),a=n(49),h=n(81),u=s("wks"),_=i.Symbol,c=h?_:_&&_.withoutSetter||o;t.exports=function(t){return r(u,t)||(a&&r(_,t)?u[t]=_[t]:u[t]=c("Symbol."+t)),u[t]}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var i=n(2);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(7);t.exports=function(t){if(!i(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){var i=n(0),s=n(20).f,r=n(9),o=n(11),a=n(23),h=n(73),u=n(46);t.exports=function(t,e){var n,_,c,g,l,f=t.target,d=t.global,p=t.stat;if(n=d?i:p?i[f]||a(f,{}):(i[f]||{}).prototype)for(_ in e){if(g=e[_],c=t.noTargetGet?(l=s(n,_))&&l.value:n[_],!u(d?_:f+(p?".":"#")+_,t.forced)&&void 0!==c){if(typeof g==typeof c)continue;h(g,c)}(t.sham||c&&c.sham)&&r(g,"sham",!0),o(n,_,g,t)}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(3),s=n(40),r=n(5),o=n(39),a=Object.defineProperty;e.f=i?a:function(t,e,n){if(r(t),e=o(e,!0),r(n),s)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(3),s=n(8),r=n(21);t.exports=i?function(t,e,n){return s.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(0),s=n(9),r=n(4),o=n(23),a=n(24),h=n(18),u=h.get,_=h.enforce,c=String(String).split("String");(t.exports=function(t,e,n,a){var h=!!a&&!!a.unsafe,u=!!a&&!!a.enumerable,g=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof e||r(n,"name")||s(n,"name",e),_(n).source=c.join("string"==typeof e?e:"")),t!==i?(h?!g&&t[e]&&(u=!0):delete t[e],u?t[e]=n:s(t,e,n)):u?t[e]=n:o(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||a(this)}))},function(t,e,n){var i=n(75),s=n(0),r=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?r(i[t])||r(s[t]):i[t]&&i[t][e]||s[t]&&s[t][e]}},function(t,e){t.exports=!1},function(t,e){t.exports={}},function(t,e,n){(function(t){!function(t,e){"use strict";t.wings=t.wings||{},t.wings.jsCanvas=t.wings.jsCanvas||{},t.wings.core=t.wings.core||{},t.hxPixels=t.hxPixels||{},t.hxPixels._Pixels=t.hxPixels._Pixels||{},t.hxDaedalus=t.hxDaedalus||{},t.hxDaedalus.view=t.hxDaedalus.view||{},t.hxDaedalus.iterators=t.hxDaedalus.iterators||{},t.hxDaedalus.factories=t.hxDaedalus.factories||{},t.hxDaedalus.data=t.hxDaedalus.data||{},t.hxDaedalus.data.math=t.hxDaedalus.data.math||{},t.hxDaedalus.data.graph=t.hxDaedalus.data.graph||{},t.hxDaedalus.ai=t.hxDaedalus.ai||{},t.hxDaedalus.ai.trajectory=t.hxDaedalus.ai.trajectory||{};var n=function(){return st.__string_rec(this,"")};var i=function(){};i.__name__=!0,i.cca=function(t,e){var n=t.charCodeAt(e);if(n==n)return n},i.substr=function(t,e,n){if(null==n)n=t.length;else if(n<0){if(0!=e)return"";n=t.length+n}return t.substr(e,n)},Math.__name__=!0;var s=function(){};s.__name__=!0,s.string=function(t){return st.__string_rec(t,"")},s.parseInt=function(t){var e=parseInt(t,10);return 0!=e||120!=i.cca(t,1)&&88!=i.cca(t,1)||(e=parseInt(t)),isNaN(e)?null:e};var r=function(){};r.__name__=!0,r.hex=function(t,e){for(var n="";n="0123456789ABCDEF".charAt(15&t)+n,(t>>>=4)>0;);if(null!=e)for(;n.length<e;)n="0"+n;return n};var o=function(){};o.__name__=!0;var a=function(){this.h={__keys__:{}}};a.__name__=!0,a.__interfaces__=[o],a.prototype={set:function(t,e){var n=t.__id__||(t.__id__=++a.count);this.h[n]=e,this.h.__keys__[n]=t},__class__:a};var h=function(){this.h={}};h.__name__=!0,h.__interfaces__=[o],h.prototype={setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},__class__:h};var u=function(t){this.length=t.byteLength,this.b=new bt(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};u.__name__=!0,u.prototype={blit:function(t,e,n,i){if(t<0||n<0||i<0||t+i>this.length||n+i>e.length)throw new it(_.OutsideBounds);0==n&&i==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(n,n+i),t)},__class__:u};var _={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:["Blocked",0]};_.Blocked.toString=n,_.Blocked.__enum__=_,_.Overflow=["Overflow",1],_.Overflow.toString=n,_.Overflow.__enum__=_,_.OutsideBounds=["OutsideBounds",2],_.OutsideBounds.toString=n,_.OutsideBounds.__enum__=_,_.Custom=function(t){var e=["Custom",3,t];return e.__enum__=_,e.toString=n,e};var c=t.hxDaedalus.ai.AStar=function(){this.iterEdge=new X};c.__name__=!0,c.prototype={dispose:function(){this._mesh=null,this.closedFaces=null,this.sortedOpenedFaces=null,this.openedFaces=null,this.entryEdges=null,this.entryX=null,this.entryY=null,this.scoreF=null,this.scoreG=null,this.scoreH=null,this.predecessor=null},get_radius:function(){return this._radius},set_radius:function(t){return this._radius=t,this.radiusSquared=this._radius*this._radius,this.diameter=2*this._radius,this.diameterSquared=this.diameter*this.diameter,t},set_mesh:function(t){return this._mesh=t,t},findPath:function(t,e,n,i,s,r){var o,h,u;switch(this.closedFaces=new a,this.sortedOpenedFaces=[],this.openedFaces=new a,this.entryEdges=new a,this.entryX=new a,this.entryY=new a,this.scoreF=new a,this.scoreG=new a,this.scoreH=new a,this.predecessor=new a,(o=k.locatePosition(t,e,this._mesh))[1]){case 0:return void(u=o[2]);case 1:if((h=o[2]).get_isConstrained())return;this.fromFace=h.get_leftFace();break;case 2:var _=o[2];this.fromFace=_}switch((o=k.locatePosition(n,i,this._mesh))[1]){case 0:u=o[2],this.toFace=u.get_edge().get_leftFace();break;case 1:h=o[2],this.toFace=h.get_leftFace();break;case 2:var c=o[2];this.toFace=c}this.sortedOpenedFaces.push(this.fromFace),this.entryEdges.set(this.fromFace,null),this.entryX.set(this.fromFace,t),this.entryY.set(this.fromFace,e),this.scoreG.set(this.fromFace,0);var g,l,f,d,p,x=Math.sqrt((n-t)*(n-t)+(i-e)*(i-e));this.scoreH.set(this.fromFace,x),this.scoreF.set(this.fromFace,x);for(var v,m=new D,y=new D,E=new D;;){if(0==this.sortedOpenedFaces.length){this.curFace=null;break}if(this.curFace=this.sortedOpenedFaces.pop(),this.curFace==this.toFace)break;for(this.iterEdge.set_fromFace(this.curFace);null!=(g=this.iterEdge.next());)if(!g.get_isConstrained()&&(l=g.get_rightFace(),!this.closedFaces.h[l.__id__])){if(this.curFace!=this.fromFace&&this._radius>0&&!this.isWalkableByRadius(this.entryEdges.h[this.curFace.__id__],this.curFace,g))continue;if(m.x=this.entryX.h[this.curFace.__id__],m.y=this.entryY.h[this.curFace.__id__],y.x=(g.get_originVertex().get_pos().x+g.get_destinationVertex().get_pos().x)/2,y.y=(g.get_originVertex().get_pos().y+g.get_destinationVertex().get_pos().y)/2,E.x=y.x-n,E.y=y.y-i,p=E.get_length(),E.x=m.x-y.x,E.y=m.y-y.y,f=p+(d=this.scoreG.h[this.curFace.__id__]+E.get_length()),v=!1,null!=this.openedFaces.h[l.__id__]&&this.openedFaces.h[l.__id__]?this.scoreF.h[l.__id__]>f&&(v=!0):(this.sortedOpenedFaces.push(l),this.openedFaces.set(l,!0),v=!0),v){this.entryEdges.set(l,g);var w=y.x;this.entryX.set(l,w);var b=y.y;this.entryY.set(l,b),this.scoreF.set(l,f),this.scoreG.set(l,d),this.scoreH.set(l,p);var C=this.curFace;this.predecessor.set(l,C)}}this.openedFaces.set(this.curFace,!1),this.closedFaces.set(this.curFace,!0),this.sortedOpenedFaces.sort(ft(this,this.sortingFaces))}if(null!=this.curFace)for(s.push(this.curFace);this.curFace!=this.fromFace;)r.unshift(this.entryEdges.h[this.curFace.__id__]),this.curFace=this.predecessor.h[this.curFace.__id__],s.unshift(this.curFace)},sortingFaces:function(t,e){return this.scoreF.h[t.__id__]==this.scoreF.h[e.__id__]?0:this.scoreF.h[t.__id__]<this.scoreF.h[e.__id__]?1:-1},isWalkableByRadius:function(t,e,n){var i,s=null,r=null,o=null;if(t.get_originVertex()==n.get_originVertex()?(s=t.get_destinationVertex(),r=n.get_destinationVertex(),o=t.get_originVertex()):t.get_destinationVertex()==n.get_destinationVertex()?(s=t.get_originVertex(),r=n.get_originVertex(),o=t.get_destinationVertex()):t.get_originVertex()==n.get_destinationVertex()?(s=t.get_destinationVertex(),r=n.get_originVertex(),o=t.get_originVertex()):t.get_destinationVertex()==n.get_originVertex()&&(s=t.get_originVertex(),r=n.get_destinationVertex(),o=t.get_destinationVertex()),(o.get_pos().x-s.get_pos().x)*(r.get_pos().x-s.get_pos().x)+(o.get_pos().y-s.get_pos().y)*(r.get_pos().y-s.get_pos().y)<=0)return(o.get_pos().x-s.get_pos().x)*(o.get_pos().x-s.get_pos().x)+(o.get_pos().y-s.get_pos().y)*(o.get_pos().y-s.get_pos().y)>=this.diameterSquared;if((o.get_pos().x-r.get_pos().x)*(s.get_pos().x-r.get_pos().x)+(o.get_pos().y-r.get_pos().y)*(s.get_pos().y-r.get_pos().y)<=0)return(o.get_pos().x-r.get_pos().x)*(o.get_pos().x-r.get_pos().x)+(o.get_pos().y-r.get_pos().y)*(o.get_pos().y-r.get_pos().y)>=this.diameterSquared;if((i=e.get_edge()!=t&&e.get_edge().get_oppositeEdge()!=t&&e.get_edge()!=n&&e.get_edge().get_oppositeEdge()!=n?e.get_edge():e.get_edge().get_nextLeftEdge()!=t&&e.get_edge().get_nextLeftEdge().get_oppositeEdge()!=t&&e.get_edge().get_nextLeftEdge()!=n&&e.get_edge().get_nextLeftEdge().get_oppositeEdge()!=n?e.get_edge().get_nextLeftEdge():e.get_edge().get_prevLeftEdge()).get_isConstrained()){var h=new D(o.get_pos().x,o.get_pos().y);return k.projectOrthogonaly(h,i),(h.x-o.get_pos().x)*(h.x-o.get_pos().x)+(h.y-o.get_pos().y)*(h.y-o.get_pos().y)>=this.diameterSquared}var u=(o.get_pos().x-s.get_pos().x)*(o.get_pos().x-s.get_pos().x)+(o.get_pos().y-s.get_pos().y)*(o.get_pos().y-s.get_pos().y),_=(o.get_pos().x-r.get_pos().x)*(o.get_pos().x-r.get_pos().x)+(o.get_pos().y-r.get_pos().y)*(o.get_pos().y-r.get_pos().y);if(u<this.diameterSquared||_<this.diameterSquared)return!1;var c,g,l,f,d,p,x=[],v=[],m=new a;for(v.push(i),i.get_leftFace()==e?(x.push(i.get_rightFace()),m.set(i.get_rightFace(),!0)):(x.push(i.get_leftFace()),m.set(i.get_leftFace(),!0));x.length>0;){if(c=x.shift(),g=v.shift(),c.get_edge()==g||c.get_edge()==g.get_oppositeEdge()?(l=c.get_edge().get_nextLeftEdge(),d=c.get_edge().get_nextLeftEdge().get_nextLeftEdge()):c.get_edge().get_nextLeftEdge()==g||c.get_edge().get_nextLeftEdge()==g.get_oppositeEdge()?(l=c.get_edge(),d=c.get_edge().get_nextLeftEdge().get_nextLeftEdge()):(l=c.get_edge(),d=c.get_edge().get_nextLeftEdge()),f=l.get_leftFace()==c?l.get_rightFace():l.get_leftFace(),p=d.get_leftFace()==c?d.get_rightFace():d.get_leftFace(),!m.h[f.__id__]&&k.distanceSquaredVertexToEdge(o,l)<this.diameterSquared){if(l.get_isConstrained())return!1;x.push(f),v.push(l),m.set(f,!0)}if(!m.h[p.__id__]&&k.distanceSquaredVertexToEdge(o,d)<this.diameterSquared){if(d.get_isConstrained())return!1;x.push(p),v.push(d),m.set(p,!0)}}return!0},__class__:c};var g=t.hxDaedalus.ai.EntityAI=function(){this._radius=10,this.x=this.y=0,this.dirNormX=1,this.dirNormY=0};g.__name__=!0,g.prototype={buildApproximation:function(){this._approximateObject=new b,this._approximateObject.get_matrix().translate(this.x,this.y);var t=[];if(this._approximateObject.set_coordinates(t),0!=this._radius)for(var e=0;e<6;){var n=e++;t.push(this._radius*Math.cos(2*Math.PI*n/6)),t.push(this._radius*Math.sin(2*Math.PI*n/6)),t.push(this._radius*Math.cos(2*Math.PI*(n+1)/6)),t.push(this._radius*Math.sin(2*Math.PI*(n+1)/6))}},get_approximateObject:function(){return this._approximateObject.get_matrix().identity(),this._approximateObject.get_matrix().translate(this.x,this.y),this._approximateObject},get_radius:function(){return this._radius},get_radiusSquared:function(){return this._radiusSquared},set_radius:function(t){return this._radius=t,this._radiusSquared=this._radius*this._radius,t},__class__:g};var l=t.hxDaedalus.ai.Funnel=function(){this._currPoolPointsIndex=0,this._poolPointsSize=3e3,this._numSamplesCircle=16,this._radiusSquared=0,this._radius=0,this._poolPoints=[];for(var t=0,e=this._poolPointsSize;t<e;){t++;this._poolPoints.push(new D)}};l.__name__=!0,l.prototype={dispose:function(){this._sampleCircle=null},getPoint:function(t,e){return null==e&&(e=0),null==t&&(t=0),this.__point=this._poolPoints[this._currPoolPointsIndex],this.__point.setXY(t,e),this._currPoolPointsIndex++,this._currPoolPointsIndex==this._poolPointsSize&&(this._poolPoints.push(new D),this._poolPointsSize++),this.__point},getCopyPoint:function(t){return this.getPoint(t.x,t.y)},get_radius:function(){return this._radius},set_radius:function(t){if(this._radius=Math.max(0,t),this._radiusSquared=this._radius*this._radius,this._sampleCircle=[],0==this.get_radius())return 0;for(var e=0,n=this._numSamplesCircle;e<n;){var i=e++;this._sampleCircle.push(new D(this._radius*Math.cos(-2*Math.PI*i/this._numSamplesCircle),this._radius*Math.sin(-2*Math.PI*i/this._numSamplesCircle)))}return this._sampleCircleDistanceSquared=(this._sampleCircle[0].x-this._sampleCircle[1].x)*(this._sampleCircle[0].x-this._sampleCircle[1].x)+(this._sampleCircle[0].y-this._sampleCircle[1].y)*(this._sampleCircle[0].y-this._sampleCircle[1].y),this._radius},findPath:function(t,e,n,i,s,r,o){if(this._currPoolPointsIndex=0,this._radius>0){var h,u,_,c,g,l=s[0];_=l.get_edge().get_originVertex().get_pos(),c=l.get_edge().get_destinationVertex().get_pos(),g=l.get_edge().get_nextLeftEdge().get_destinationVertex().get_pos(),(h=(_.x-t)*(_.x-t)+(_.y-e)*(_.y-e))<=this._radiusSquared?(u=Math.sqrt(h),t=1.01*this._radius*((t-_.x)/u)+_.x,e=1.01*this._radius*((e-_.y)/u)+_.y):(h=(c.x-t)*(c.x-t)+(c.y-e)*(c.y-e))<=this._radiusSquared?(u=Math.sqrt(h),t=1.01*this._radius*((t-c.x)/u)+c.x,e=1.01*this._radius*((e-c.y)/u)+c.y):(h=(g.x-t)*(g.x-t)+(g.y-e)*(g.y-e))<=this._radiusSquared&&(u=Math.sqrt(h),t=1.01*this._radius*((t-g.x)/u)+g.x,e=1.01*this._radius*((e-g.y)/u)+g.y),_=(l=s[s.length-1]).get_edge().get_originVertex().get_pos(),c=l.get_edge().get_destinationVertex().get_pos(),g=l.get_edge().get_nextLeftEdge().get_destinationVertex().get_pos(),(h=(_.x-n)*(_.x-n)+(_.y-i)*(_.y-i))<=this._radiusSquared?(u=Math.sqrt(h),n=1.01*this._radius*((n-_.x)/u)+_.x,i=1.01*this._radius*((i-_.y)/u)+_.y):(h=(c.x-n)*(c.x-n)+(c.y-i)*(c.y-i))<=this._radiusSquared?(u=Math.sqrt(h),n=1.01*this._radius*((n-c.x)/u)+c.x,i=1.01*this._radius*((i-c.y)/u)+c.y):(h=(g.x-n)*(g.x-n)+(g.y-i)*(g.y-i))<=this._radiusSquared&&(u=Math.sqrt(h),n=1.01*this._radius*((n-g.x)/u)+g.x,i=1.01*this._radius*((i-g.y)/u)+g.y)}var f,d,p,x;if(f=new D(t,e),d=new D(n,i),1==s.length)return o.push(f.x),o.push(f.y),o.push(d.x),void o.push(d.y);var v,m=null,y=null,E=k.isInFace(t,e,s[0]);if(1==E[1]){var w=E[2];r[0]==w&&(r.shift(),s.shift())}var b=[],C=[];b.push(f),C.push(f);var S=new a,P=[],F=new a,V=new a;F.set(f,0),m=r[0];var T,O,L,N=k.getRelativePosition2(t,e,m);O=this.getCopyPoint(m.get_destinationVertex().get_pos()),L=this.getCopyPoint(m.get_originVertex().get_pos()),P.push(O),P.push(L),V.set(f,O),V.set(O,L),T=L,1==N?(F.set(O,1),F.set(L,-1),S.set(m.get_destinationVertex(),1),S.set(m.get_originVertex(),-1)):-1==N&&(F.set(O,-1),F.set(L,1),S.set(m.get_destinationVertex(),-1),S.set(m.get_originVertex(),1));for(var M=r[0].get_originVertex(),j=r[0].get_destinationVertex(),R=1,I=r.length;R<I;){(m=r[R++]).get_originVertex()==M?y=m.get_destinationVertex():m.get_destinationVertex()==M?y=m.get_originVertex():m.get_originVertex()==j?(y=m.get_destinationVertex(),M=j):m.get_destinationVertex()==j&&(y=m.get_originVertex(),M=j),O=this.getCopyPoint(y.get_pos()),P.push(O),v=-S.h[M.__id__],F.set(O,v),V.set(T,O),S.set(y,v),T=O,j=M,M=y}V.set(T,d),F.set(d,0);var A,B=[],q=new a;B.push(f),q.set(f,0);for(var Y=0,X=P.length;Y<X;){if(A=P[Y++],-1==F.h[A.__id__]){for(x=b.length-2;x>=0;){if(-1!=(v=k.getDirection(b[x].x,b[x].y,b[x+1].x,b[x+1].y,A.x,A.y))){b.shift();for(var G=0,W=x;G<W;){G++;B.push(b[0]),q.set(b[0],1),b.shift()}B.push(b[0]),q.set(b[0],1),C.splice(0,C.length),C.push(b[0]),C.push(A);break}--x}for(C.push(A),x=C.length-3;x>=0&&-1!=(v=k.getDirection(C[x].x,C[x].y,C[x+1].x,C[x+1].y,A.x,A.y));)C.splice(x+1,1),--x}else{for(x=C.length-2;x>=0;){if(1!=(v=k.getDirection(C[x].x,C[x].y,C[x+1].x,C[x+1].y,A.x,A.y))){C.shift();for(var z=0,H=x;z<H;){z++;B.push(C[0]),q.set(C[0],-1),C.shift()}B.push(C[0]),q.set(C[0],-1),b.splice(0,b.length),b.push(C[0]),b.push(A);break}--x}for(b.push(A),x=b.length-3;x>=0&&1!=(v=k.getDirection(b[x].x,b[x].y,b[x+1].x,b[x+1].y,A.x,A.y));)b.splice(x+1,1),--x}}var U=!1;for(x=C.length-2;x>=0;){if(1!=(v=k.getDirection(C[x].x,C[x].y,C[x+1].x,C[x+1].y,n,i))){C.shift();for(var Q=0,K=x+1;Q<K;){Q++;B.push(C[0]),q.set(C[0],-1),C.shift()}B.push(d),q.set(d,0),U=!0;break}--x}if(!U)for(x=b.length-2;x>=0;){if(-1!=(v=k.getDirection(b[x].x,b[x].y,b[x+1].x,b[x+1].y,n,i))){b.shift();for(var $=0,J=x+1;$<J;){$++;B.push(b[0]),q.set(b[0],1),b.shift()}B.push(d),q.set(d,0),U=!0;break}--x}U||(B.push(d),q.set(d,0),U=!0);var Z=[];if(this.get_radius()>0){var tt=[];if(2==B.length)this.adjustWithTangents(B[0],!1,B[1],!1,F,V,tt,Z);else if(B.length>2){if(this.adjustWithTangents(B[0],!1,B[1],!0,F,V,tt,Z),B.length>3)for(var et=1,nt=B.length-3+1;et<nt;){var it=et++;this.adjustWithTangents(B[it],!0,B[it+1],!0,F,V,tt,Z)}var st=B.length;this.adjustWithTangents(B[st-2],!0,B[st-1],!1,F,V,tt,Z)}tt.push(d),this.checkAdjustedPath(tt,Z,F);var rt=[];for(p=tt.length-2;p>=1;){for(this.smoothAngle(Z[2*p-1],tt[p],Z[2*p],F.h[tt[p].__id__],rt);0!=rt.length;){var ot=2*p;Z.splice(ot,0);var at=rt.pop();Z.splice(ot,0,at)}--p}}else Z=B;for(var ht=0,ut=Z.length;ht<ut;){var _t=ht++;o.push(Z[_t].x),o.push(Z[_t].y)}},adjustWithTangents:function(t,e,n,i,s,r,o,a){var h=[],u=s.h[t.__id__],_=s.h[n.__id__],c=null,g=null;if(e||i)if(e)if(i)if(1==u&&1==_)k.tangentsParalCircleToCircle(this._radius,t.x,t.y,n.x,n.y,h),c=this.getPoint(h[2],h[3]),g=this.getPoint(h[4],h[5]);else if(-1==u&&-1==_)k.tangentsParalCircleToCircle(this._radius,t.x,t.y,n.x,n.y,h),c=this.getPoint(h[0],h[1]),g=this.getPoint(h[6],h[7]);else if(1==u&&-1==_){if(!k.tangentsCrossCircleToCircle(this._radius,t.x,t.y,n.x,n.y,h))return;c=this.getPoint(h[2],h[3]),g=this.getPoint(h[6],h[7])}else{if(!k.tangentsCrossCircleToCircle(this._radius,t.x,t.y,n.x,n.y,h))return;c=this.getPoint(h[0],h[1]),g=this.getPoint(h[4],h[5])}else{if(!k.tangentsPointToCircle(n.x,n.y,t.x,t.y,this._radius,h))return;h.length>0&&(1==u?(c=this.getPoint(h[0],h[1]),g=n):(c=this.getPoint(h[2],h[3]),g=n))}else{if(!k.tangentsPointToCircle(t.x,t.y,n.x,n.y,this._radius,h))return;1==_?(c=t,g=this.getPoint(h[2],h[3])):(c=t,g=this.getPoint(h[0],h[1]))}else c=t,g=n;for(var l=r.h[t.__id__];l!=n;){if(k.distanceSquaredPointToSegment(l.x,l.y,c.x,c.y,g.x,g.y)<this._radiusSquared)return this.adjustWithTangents(t,e,l,!0,s,r,o,a),void this.adjustWithTangents(l,!0,n,i,s,r,o,a);l=r.h[l.__id__]}a.push(c),a.push(g),o.push(t)},checkAdjustedPath:function(t,e,n){for(var i,s,r,o,a,h,u,_,c,g=!0,l=[],f=null,d=null;g;){g=!1;for(var p=2;p<t.length;){if(a=t[p],h=n.h[a.__id__],r=t[p-1],o=n.h[r.__id__],i=t[p-2],s=n.h[i.__id__],o==h&&(u=e[2*(p-2)],_=e[2*(p-1)-1],c=e[2*(p-1)],(u.x-_.x)*(c.x-_.x)+(u.y-_.y)*(c.y-_.y)>0)){2==p?(k.tangentsPointToCircle(i.x,i.y,a.x,a.y,this._radius,l),1==h?(f=i,d=this.getPoint(l[2],l[3])):(f=i,d=this.getPoint(l[0],l[1]))):p==t.length-1?(k.tangentsPointToCircle(a.x,a.y,i.x,i.y,this._radius,l),1==s?(f=this.getPoint(l[0],l[1]),d=a):(f=this.getPoint(l[2],l[3]),d=a)):1==s&&-1==h?(k.tangentsCrossCircleToCircle(this._radius,i.x,i.y,a.x,a.y,l),f=this.getPoint(l[2],l[3]),d=this.getPoint(l[6],l[7])):-1==s&&1==h?(k.tangentsCrossCircleToCircle(this._radius,i.x,i.y,a.x,a.y,l),f=this.getPoint(l[0],l[1]),d=this.getPoint(l[4],l[5])):1==s&&1==h?(k.tangentsParalCircleToCircle(this._radius,i.x,i.y,a.x,a.y,l),f=this.getPoint(l[2],l[3]),d=this.getPoint(l[4],l[5])):-1==s&&-1==h&&(k.tangentsParalCircleToCircle(this._radius,i.x,i.y,a.x,a.y,l),f=this.getPoint(l[0],l[1]),d=this.getPoint(l[6],l[7]));var x=2*(p-2);e.splice(x,1),e.splice(x,0,f),x=2*p-1,e.splice(x,1),e.splice(x,0,d),t.splice(p-1,1),e.splice(2*(p-1)-1,2),l.splice(0,l.length),--p}++p}}},smoothAngle:function(t,e,n,i,s){var r=k.getDirection(t.x,t.y,e.x,e.y,n.x,n.y);if(!((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y)<=this._sampleCircleDistanceSquared)){for(var o,a,h,u,_,c=0,g=0,l=this._numSamplesCircle;g<l;){var f=g++;if(h=!1,u=e.x+this._sampleCircle[f].x,_=e.y+this._sampleCircle[f].y,o=k.getDirection(t.x,t.y,e.x,e.y,u,_),a=k.getDirection(e.x,e.y,n.x,n.y,u,_),1==i?-1==r?-1==o&&-1==a&&(h=!0):-1!=o&&-1!=a||(h=!0):1==r?1==o&&1==a&&(h=!0):1!=o&&1!=a||(h=!0),h){s.splice(c,0);var d=new D(u,_);s.splice(c,0,d),++c}else c=0}-1==i&&s.reverse()}},__class__:l};var f=t.hxDaedalus.ai.PathFinder=function(){this.astar=new c,this.funnel=new l,this.listFaces=[],this.listEdges=[]};f.__name__=!0,f.prototype={dispose:function(){this._mesh=null,this.astar.dispose(),this.astar=null,this.funnel.dispose(),this.funnel=null,this.listEdges=null,this.listFaces=null},get_mesh:function(){return this._mesh},set_mesh:function(t){return this._mesh=t,this.astar.set_mesh(this._mesh),t},findPath:function(t,e,n){n.splice(0,n.length);this._mesh,this.entity;k.isCircleIntersectingAnyConstraint(t,e,this.entity.get_radius(),this._mesh)||(this.astar.set_radius(this.entity.get_radius()),this.funnel.set_radius(this.entity.get_radius()),this.listFaces.splice(0,this.listFaces.length),this.listEdges.splice(0,this.listEdges.length),this.astar.findPath(this.entity.x,this.entity.y,t,e,this.listFaces,this.listEdges),0!=this.listFaces.length&&this.funnel.findPath(this.entity.x,this.entity.y,t,e,this.listFaces,this.listEdges,n))},__class__:f};var d=t.hxDaedalus.ai.trajectory.LinearPathSampler=function(){this._samplingDistanceSquared=1,this._samplingDistance=1,this._preCompX=[],this._preCompY=[]};d.__name__=!0,d.pythag=function(t,e){return Math.sqrt(t*t+e*e)},d.prototype={dispose:function(){this.entity=null,this._path=null,this._preCompX=null,this._preCompY=null},get_x:function(){return this._currentX},get_y:function(){return this._currentY},get_hasPrev:function(){return this._hasPrev},get_hasNext:function(){return this._hasNext},get_count:function(){return this._count},set_count:function(t){return this._count=t,this._count<0&&(this._count=0),this._count>this.get_countMax()-1&&(this._count=this.get_countMax()-1),this._hasPrev=0!=this._count,this._hasNext=this._count!=this.get_countMax()-1,this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),this._count},get_countMax:function(){return this._preCompX.length-1},get_samplingDistance:function(){return this._samplingDistance},set_samplingDistance:function(t){return this._samplingDistance=t,this._samplingDistanceSquared=this._samplingDistance*this._samplingDistance,t},set_path:function(t){return this._path=t,this._preComputed=!1,this.reset(),t},reset:function(){if(this._path.length>0){this._path.length;this._currentX=this._path[0],this._currentY=this._path[1],this._iPrev=0,this._iNext=2,this._hasPrev=!1,this._hasNext=!0,this._count=0,this.updateEntity()}else this._hasPrev=!1,this._hasNext=!1,this._count=0},preCompute:function(){for(this._preCompX.splice(0,this._preCompX.length),this._preCompY.splice(0,this._preCompY.length),this._count=0,this._preCompX.push(this._currentX),this._preCompY.push(this._currentY),this._preComputed=!1;this.next();)this._preCompX.push(this._currentX),this._preCompY.push(this._currentY);this.reset(),this._preComputed=!0},prev:function(){if(!this._hasPrev)return!1;if(this._hasNext=!0,this._preComputed)return this._count--,0==this._count&&(this._hasPrev=!1),this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),!0;for(var t=this._samplingDistance,e=0;;){var n=this._path[this._iPrev],i=this._path[this._iPrev+1],s=this._currentX-n,r=this._currentY-i;if(!((e=Math.sqrt(s*s+r*r))<t))break;if(t-=e,this._iPrev-=2,this._iNext-=2,0==this._iNext)break}return 0==this._iNext?(this._currentX=this._path[0],this._currentY=this._path[1],this._hasPrev=!1,this._iNext=2,this._iPrev=0,this.updateEntity(),!0):(this._currentX+=(this._path[this._iPrev]-this._currentX)*t/e,this._currentY+=(this._path[this._iPrev+1]-this._currentY)*t/e,this.updateEntity(),!0)},next:function(){if(!this._hasNext)return!1;if(this._hasPrev=!0,this._preComputed)return this._count++,this._count==this._preCompX.length-1&&(this._hasNext=!1),this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),!0;for(var t=this._samplingDistance,e=0;;){var n=this._path[this._iNext],i=this._path[this._iNext+1],s=this._currentX-n,r=this._currentY-i;if(!((e=Math.sqrt(s*s+r*r))<t))break;if(t-=e,this._currentX=this._path[this._iNext],this._currentY=this._path[this._iNext+1],this._iPrev+=2,this._iNext+=2,this._iNext==this._path.length)break}return this._iNext==this._path.length?(this._currentX=this._path[this._iPrev],this._currentY=this._path[this._iPrev+1],this._hasNext=!1,this._iNext=this._path.length-2,this._iPrev=this._iNext-2,this.updateEntity(),!0):(this._currentX+=(this._path[this._iNext]-this._currentX)*t/e,this._currentY+=(this._path[this._iNext+1]-this._currentY)*t/e,this.updateEntity(),!0)},updateEntity:function(){if(null!=this.entity){isNaN(this._currentX)&&isNaN(this._currentY);this.entity.x=this._currentX,this.entity.y=this._currentY}},__class__:d};var p=t.hxDaedalus.ai.trajectory.PathIterator=function(){};p.__name__=!0,p.prototype={get_entity:function(){return this._entity},set_entity:function(t){return this._entity=t,t},get_x:function(){return this._currentX},get_y:function(){return this._currentY},get_hasPrev:function(){return this._hasPrev},get_hasNext:function(){return this._hasNext},get_count:function(){return this._count},get_countMax:function(){return this._countMax},set_path:function(t){return this._path=t,this._countMax=this._path.length/2|0,this.reset(),t},reset:function(){this._count=0,this._currentX=this._path[this._count],this._currentY=this._path[this._count+1],this.updateEntity(),this._hasPrev=!1,this._hasNext=this._path.length>2},prev:function(){return!!this._hasPrev&&(this._hasNext=!0,this._count--,this._currentX=this._path[2*this._count],this._currentY=this._path[2*this._count+1],this.updateEntity(),0==this._count&&(this._hasPrev=!1),!0)},next:function(){return!!this._hasNext&&(this._hasPrev=!0,this._count++,this._currentX=this._path[2*this._count],this._currentY=this._path[2*this._count+1],this.updateEntity(),2*(this._count+1)==this._path.length&&(this._hasNext=!1),!0)},updateEntity:function(){null!=this._entity&&(this._entity.x=this._currentX,this._entity.y=this._currentY)},__class__:p};var x=t.hxDaedalus.data.Constants=function(){};x.__name__=!0;var v=t.hxDaedalus.data.ConstraintSegment=function(){this._id=v.INC,v.INC++,this._edges=[]};v.__name__=!0,v.prototype={get_id:function(){return this._id},addEdge:function(t){-1==this._edges.indexOf(t)&&-1==this._edges.indexOf(t.get_oppositeEdge())&&this._edges.push(t)},removeEdge:function(t){var e=this._edges.indexOf(t);-1==e&&(e=this._edges.indexOf(t.get_oppositeEdge())),-1!=e&&this._edges.splice(e,1)},get_edges:function(){return this._edges},dispose:function(){this._edges=null,this.fromShape=null},toString:function(){return"seg_id "+this._id},__class__:v};var m=t.hxDaedalus.data.ConstraintShape=function(){this._id=m.INC,m.INC++,this.segments=[]};m.__name__=!0,m.prototype={get_id:function(){return this._id},dispose:function(){for(;this.segments.length>0;)this.segments.pop().dispose();this.segments=null},__class__:m};var y=t.hxDaedalus.data.Edge=function(){this.colorDebug=-1,this._id=y.INC,y.INC++,this.fromConstraintSegments=[]};y.__name__=!0,y.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},get_isConstrained:function(){return this._isConstrained},setDatas:function(t,e,n,i,s,r){null==r&&(r=!1),null==s&&(s=!0),this._isConstrained=r,this._isReal=s,this._originVertex=t,this._oppositeEdge=e,this._nextLeftEdge=n,this._leftFace=i},addFromConstraintSegment:function(t){-1==this.fromConstraintSegments.indexOf(t)&&this.fromConstraintSegments.push(t)},removeFromConstraintSegment:function(t){var e=this.fromConstraintSegments.indexOf(t);-1!=e&&this.fromConstraintSegments.splice(e,1)},set_originVertex:function(t){return this._originVertex=t,t},set_nextLeftEdge:function(t){return this._nextLeftEdge=t,t},set_leftFace:function(t){return this._leftFace=t,t},set_isConstrained:function(t){return this._isConstrained=t,t},dispose:function(){this._originVertex=null,this._oppositeEdge=null,this._nextLeftEdge=null,this._leftFace=null,this.fromConstraintSegments=null},get_originVertex:function(){return this._originVertex},get_destinationVertex:function(){return this.get_oppositeEdge().get_originVertex()},get_oppositeEdge:function(){return this._oppositeEdge},get_nextLeftEdge:function(){return this._nextLeftEdge},get_prevLeftEdge:function(){return this._nextLeftEdge.get_nextLeftEdge()},get_nextRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge().get_nextLeftEdge().get_oppositeEdge()},get_prevRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge().get_oppositeEdge()},get_rotLeftEdge:function(){return this._nextLeftEdge.get_nextLeftEdge().get_oppositeEdge()},get_rotRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge()},get_leftFace:function(){return this._leftFace},get_rightFace:function(){return this._oppositeEdge.get_leftFace()},toString:function(){return"edge "+this.get_originVertex().get_id()+" - "+this.get_destinationVertex().get_id()},__class__:y};var E=t.hxDaedalus.data.Face=function(){this.colorDebug=-1,this._id=E.INC,E.INC++};E.__name__=!0,E.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},set_datas:function(t){this._isReal=!0,this._edge=t},setDatas:function(t,e){null==e&&(e=!0),this._isReal=e,this._edge=t},dispose:function(){this._edge=null},get_edge:function(){return this._edge},__class__:E};var w=t.hxDaedalus.data.Mesh=function(t,e){this.__objectsUpdateInProgress=!1,this.__edgesToCheck=null,this.__centerVertex=null,this._objects=null,this._constraintShapes=null,this._faces=null,this._edges=null,this._vertices=null,this._clipping=!1,this._height=0,this._width=0,this._id=w.INC,w.INC++,this._width=t,this._height=e,this._clipping=!0,this._vertices=[],this._edges=[],this._faces=[],this._constraintShapes=[],this._objects=[],this.__edgesToCheck=[]};w.__name__=!0,w.prototype={get_height:function(){return this._height},get_width:function(){return this._width},get_clipping:function(){return this._clipping},set_clipping:function(t){return this._clipping=t,t},get_id:function(){return this._id},dispose:function(){for(;this._vertices.length>0;)this._vertices.pop().dispose();for(this._vertices=null;this._edges.length>0;)this._edges.pop().dispose();for(this._edges=null;this._faces.length>0;)this._faces.pop().dispose();for(this._faces=null;this._constraintShapes.length>0;)this._constraintShapes.pop().dispose();for(this._constraintShapes=null;this._objects.length>0;)this._objects.pop().dispose();this._objects=null,this.__edgesToCheck=null,this.__centerVertex=null},get___constraintShapes:function(){return this._constraintShapes},buildFromRecord:function(t){for(var e=t.split(";"),n=0;n<e.length;)this.insertConstraintSegment(parseFloat(e[n]),parseFloat(e[n+1]),parseFloat(e[n+2]),parseFloat(e[n+3])),n+=4},insertObject:function(t){null!=t.get_constraintShape()&&this.deleteObject(t);var e,n,i,s,r,o,a,h,u,_=new m,c=t.get_coordinates(),g=t.get_matrix();t.updateMatrixFromValues();for(var l=0;l<c.length;)n=c[l],i=c[l+1],s=c[l+2],r=c[l+3],o=g.transformX(n,i),a=g.transformY(n,i),h=g.transformX(s,r),u=g.transformY(s,r),null!=(e=this.insertConstraintSegment(o,a,h,u))&&(e.fromShape=_,_.segments.push(e)),l+=4;this._constraintShapes.push(_),t.set_constraintShape(_),this.__objectsUpdateInProgress||this._objects.push(t)},deleteObject:function(t){if(null!=t.get_constraintShape()&&(this.deleteConstraintShape(t.get_constraintShape()),t.set_constraintShape(null),!this.__objectsUpdateInProgress)){var e=this._objects.indexOf(t);this._objects.splice(e,1)}},updateObjects:function(){this.__objectsUpdateInProgress=!0;for(var t=0,e=this._objects.length;t<e;){var n=t++;this._objects[n].get_hasChanged()&&(this.deleteObject(this._objects[n]),this.insertObject(this._objects[n]),this._objects[n].set_hasChanged(!1))}this.__objectsUpdateInProgress=!1},insertConstraintShape:function(t){for(var e=new m,n=null,i=0;i<t.length;)null!=(n=this.insertConstraintSegment(t[i],t[i+1],t[i+2],t[i+3]))&&(n.fromShape=e,e.segments.push(n)),i+=4;return this._constraintShapes.push(e),e},deleteConstraintShape:function(t){for(var e=0,n=t.segments.length;e<n;){var i=e++;this.deleteConstraintSegment(t.segments[i])}t.dispose(),this._constraintShapes.splice(this._constraintShapes.indexOf(t),1)},insertConstraintSegment:function(t,e,n,i){var s=this.findPositionFromBounds(t,e),r=this.findPositionFromBounds(n,i),o=t,a=e,h=n,u=i;if(this._clipping&&(0!=s||0!=r)){var _=new D;if(0!=s&&0!=r){if(t<=0&&n<=0||t>=this._width&&n>=this._width||e<=0&&i<=0||e>=this._height&&i>=this._height)return null;if(8==s&&4==r||4==s&&8==r)k.intersections2segments(t,e,n,i,0,0,0,this._height,_),o=_.x,a=_.y,k.intersections2segments(t,e,n,i,this._width,0,this._width,this._height,_),h=_.x,u=_.y;else if(2==s&&6==r||6==s&&2==r)k.intersections2segments(t,e,n,i,0,0,this._width,0,_),o=_.x,a=_.y,k.intersections2segments(t,e,n,i,0,this._height,this._width,this._height,_),h=_.x,u=_.y;else if(2==s&&8==r||8==s&&2==r){if(!k.intersections2segments(t,e,n,i,0,0,this._width,0,_))return null;o=_.x,a=_.y,k.intersections2segments(t,e,n,i,0,0,0,this._height,_),h=_.x,u=_.y}else if(2==s&&4==r||4==s&&2==r){if(!k.intersections2segments(t,e,n,i,0,0,this._width,0,_))return null;o=_.x,a=_.y,k.intersections2segments(t,e,n,i,this._width,0,this._width,this._height,_),h=_.x,u=_.y}else if(6==s&&4==r||4==s&&6==r){if(!k.intersections2segments(t,e,n,i,0,this._height,this._width,this._height,_))return null;o=_.x,a=_.y,k.intersections2segments(t,e,n,i,this._width,0,this._width,this._height,_),h=_.x,u=_.y}else if(8==s&&6==r||6==s&&8==r){if(!k.intersections2segments(t,e,n,i,0,this._height,this._width,this._height,_))return null;o=_.x,a=_.y,k.intersections2segments(t,e,n,i,0,0,0,this._height,_),h=_.x,u=_.y}else{var c=!1,g=!1;if(k.intersections2segments(t,e,n,i,0,0,this._width,0,_)&&(o=_.x,a=_.y,c=!0),k.intersections2segments(t,e,n,i,this._width,0,this._width,this._height,_)&&(c?(h=_.x,u=_.y,g=!0):(o=_.x,a=_.y,c=!0)),!g&&k.intersections2segments(t,e,n,i,0,this._height,this._width,this._height,_)&&(c?(h=_.x,u=_.y,g=!0):(o=_.x,a=_.y,c=!0)),!g&&k.intersections2segments(t,e,n,i,0,0,0,this._height,_)&&(h=_.x,u=_.y),!c)return null}}else 2==s||2==r?k.intersections2segments(t,e,n,i,0,0,this._width,0,_):4==s||4==r?k.intersections2segments(t,e,n,i,this._width,0,this._width,this._height,_):6==s||6==r?k.intersections2segments(t,e,n,i,0,this._height,this._width,this._height,_):8==s||8==r?k.intersections2segments(t,e,n,i,0,0,0,this._height,_):k.intersections2segments(t,e,n,i,0,0,this._width,0,_)||k.intersections2segments(t,e,n,i,this._width,0,this._width,this._height,_)||k.intersections2segments(t,e,n,i,0,this._height,this._width,this._height,_)||k.intersections2segments(t,e,n,i,0,0,0,this._height,_),0==s?(o=t,a=e):(o=n,a=i),h=_.x,u=_.y}var l=this.insertVertex(o,a);if(null==l)return null;var f=this.insertVertex(h,u);if(null==f)return null;if(l==f)return null;var d,p,x=new $,m=new v,E=new y,w=new y;E.setDatas(l,w,null,null,!0,!0),w.setDatas(f,E,null,null,!0,!0);var b,C,S,P,F,V=[],O=[],L=[],N=new D;for(d=l,b=T.EVertex(d);;)switch(F=!1,b[1]){case 0:for(d=b[2],x.set_fromVertex(d);null!=(p=x.next());){if(p.get_destinationVertex()==f)return p.get_isConstrained()||(p.set_isConstrained(!0),p.get_oppositeEdge().set_isConstrained(!0)),p.addFromConstraintSegment(m),p.get_oppositeEdge().fromConstraintSegments=p.fromConstraintSegments,l.addFromConstraintSegment(m),f.addFromConstraintSegment(m),m.addEdge(p),m;if(k.distanceSquaredVertexToEdge(p.get_destinationVertex(),E)<=1e-4){p.get_isConstrained()||(p.set_isConstrained(!0),p.get_oppositeEdge().set_isConstrained(!0)),p.addFromConstraintSegment(m),p.get_oppositeEdge().fromConstraintSegments=p.fromConstraintSegments,l.addFromConstraintSegment(m),m.addEdge(p),l=p.get_destinationVertex(),E.set_originVertex(l),b=T.EVertex(l),F=!0;break}}if(F)continue;for(x.set_fromVertex(d);null!=(p=x.next());)if(p=p.get_nextLeftEdge(),k.intersections2edges(p,E,N)){if(p.get_isConstrained()){for(l=this.splitEdge(p,N.x,N.y),x.set_fromVertex(d);null!=(p=x.next());)if(p.get_destinationVertex()==l){p.set_isConstrained(!0),p.get_oppositeEdge().set_isConstrained(!0),p.addFromConstraintSegment(m),p.get_oppositeEdge().fromConstraintSegments=p.fromConstraintSegments,m.addEdge(p);break}d.addFromConstraintSegment(m),E.set_originVertex(l),b=T.EVertex(l)}else V.push(p),O.unshift(p.get_nextLeftEdge()),L.push(p.get_prevLeftEdge()),p=p.get_oppositeEdge(),b=T.EEdge(p);break}break;case 1:if((C=(p=b[2]).get_nextLeftEdge()).get_destinationVertex()==f)return O.unshift(C.get_nextLeftEdge()),L.push(C),S=new y,P=new y,S.setDatas(l,P,null,null,!0,!0),P.setDatas(f,S,null,null,!0,!0),O.push(S),L.push(P),this.insertNewConstrainedEdge(m,S,V,O,L),m;if(k.distanceSquaredVertexToEdge(C.get_destinationVertex(),E)<=1e-4)O.unshift(C.get_nextLeftEdge()),L.push(C),S=new y,P=new y,S.setDatas(l,P,null,null,!0,!0),P.setDatas(C.get_destinationVertex(),S,null,null,!0,!0),O.push(S),L.push(P),this.insertNewConstrainedEdge(m,S,V,O,L),V.splice(0,V.length),O.splice(0,O.length),L.splice(0,L.length),l=C.get_destinationVertex(),E.set_originVertex(l),b=T.EVertex(l);else if(k.intersections2edges(C,E,N))if(C.get_isConstrained()){for(d=this.splitEdge(C,N.x,N.y),x.set_fromVertex(d);null!=(p=x.next());)p.get_destinationVertex()==O[0].get_originVertex()&&O.unshift(p),p.get_destinationVertex()==L[L.length-1].get_destinationVertex()&&L.push(p.get_oppositeEdge());S=new y,P=new y,S.setDatas(l,P,null,null,!0,!0),P.setDatas(d,S,null,null,!0,!0),O.push(S),L.push(P),this.insertNewConstrainedEdge(m,S,V,O,L),V.splice(0,V.length),O.splice(0,O.length),L.splice(0,L.length),l=d,E.set_originVertex(l),b=T.EVertex(l)}else V.push(C),O.unshift(C.get_nextLeftEdge()),p=C.get_oppositeEdge(),b=T.EEdge(p);else if(C=C.get_nextLeftEdge(),k.intersections2edges(C,E,N),C.get_isConstrained()){for(d=this.splitEdge(C,N.x,N.y),x.set_fromVertex(d);null!=(p=x.next());)p.get_destinationVertex()==O[0].get_originVertex()&&O.unshift(p),p.get_destinationVertex()==L[L.length-1].get_destinationVertex()&&L.push(p.get_oppositeEdge());S=new y,P=new y,S.setDatas(l,P,null,null,!0,!0),P.setDatas(d,S,null,null,!0,!0),O.push(S),L.push(P),this.insertNewConstrainedEdge(m,S,V,O,L),V.splice(0,V.length),O.splice(0,O.length),L.splice(0,L.length),l=d,E.set_originVertex(l),b=T.EVertex(l)}else V.push(C),L.push(C.get_prevLeftEdge()),p=C.get_oppositeEdge(),b=T.EEdge(p);break;case 2:b[2]}},insertNewConstrainedEdge:function(t,e,n,i,s){this._edges.push(e),this._edges.push(e.get_oppositeEdge()),e.addFromConstraintSegment(t),e.get_oppositeEdge().fromConstraintSegments=e.fromConstraintSegments,t.addEdge(e),e.get_originVertex().addFromConstraintSegment(t),e.get_destinationVertex().addFromConstraintSegment(t),this.untriangulate(n),this.triangulate(i,!0),this.triangulate(s,!0)},deleteConstraintSegment:function(t){for(var e,n=[],i=null,s=0,r=t.get_edges().length;s<r;){var o=s++;(i=t.get_edges()[o]).removeFromConstraintSegment(t),0==i.fromConstraintSegments.length&&(i.set_isConstrained(!1),i.get_oppositeEdge().set_isConstrained(!1)),(e=i.get_originVertex()).removeFromConstraintSegment(t),n.push(e)}(e=i.get_destinationVertex()).removeFromConstraintSegment(t),n.push(e);for(var a=0,h=n.length;a<h;){var u=a++;this.deleteVertex(n[u])}t.dispose()},check:function(){for(var t=0,e=this._edges.length;t<e;){var n=t++;if(null==this._edges[n].get_nextLeftEdge())return}},insertVertex:function(t,e){if(t<0||e<0||t>this._width||e>this._height)return null;this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var n=k.locatePosition(t,e,this),i=null;switch(n[1]){case 0:i=n[2];break;case 1:var s=n[2];i=this.splitEdge(s,t,e);break;case 2:var r=n[2];i=this.splitFace(r,t,e)}return this.restoreAsDelaunay(),i},flipEdge:function(t){var e=t,n=t.get_oppositeEdge(),i=new y,s=new y,r=e.get_nextLeftEdge(),o=r.get_nextLeftEdge(),a=n.get_nextLeftEdge(),h=a.get_nextLeftEdge(),u=e.get_originVertex(),_=n.get_originVertex(),c=o.get_originVertex(),g=h.get_originVertex(),l=e.get_leftFace(),f=n.get_leftFace(),d=new E,p=new E;return this._edges.push(i),this._edges.push(s),this._faces.push(p),this._faces.push(d),i.setDatas(c,s,h,p,t.get_isReal(),t.get_isConstrained()),s.setDatas(g,i,o,d,t.get_isReal(),t.get_isConstrained()),p.setDatas(i),d.setDatas(s),_.get_edge()==n&&_.setDatas(r),u.get_edge()==e&&u.setDatas(a),r.set_nextLeftEdge(i),r.set_leftFace(p),o.set_nextLeftEdge(a),o.set_leftFace(d),a.set_nextLeftEdge(s),a.set_leftFace(d),h.set_nextLeftEdge(r),h.set_leftFace(p),e.dispose(),n.dispose(),this._edges.splice(this._edges.indexOf(e),1),this._edges.splice(this._edges.indexOf(n),1),l.dispose(),f.dispose(),this._faces.splice(this._faces.indexOf(l),1),this._faces.splice(this._faces.indexOf(f),1),s},splitEdge:function(t,e,n){this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var i=t,s=i.get_oppositeEdge(),r=i.get_nextLeftEdge(),o=r.get_nextLeftEdge(),a=s.get_nextLeftEdge(),h=a.get_nextLeftEdge(),u=o.get_originVertex(),_=i.get_originVertex(),c=h.get_originVertex(),g=s.get_originVertex(),l=i.get_leftFace(),f=s.get_leftFace();if((_.get_pos().x-e)*(_.get_pos().x-e)+(_.get_pos().y-n)*(_.get_pos().y-n)<=1e-4)return _;if((g.get_pos().x-e)*(g.get_pos().x-e)+(g.get_pos().y-n)*(g.get_pos().y-n)<=1e-4)return g;var d=new C,p=new y,x=new y,v=new y,m=new y,w=new y,b=new y,S=new y,P=new y,F=new E,V=new E,T=new E,D=new E;if(this._vertices.push(d),this._edges.push(x),this._edges.push(p),this._edges.push(b),this._edges.push(w),this._edges.push(m),this._edges.push(v),this._edges.push(P),this._edges.push(S),this._faces.push(D),this._faces.push(T),this._faces.push(V),this._faces.push(F),d.setDatas(l.get_isReal()?x:m),d.get_pos().x=e,d.get_pos().y=n,k.projectOrthogonaly(d.get_pos(),i),x.setDatas(d,p,o,F,l.get_isReal()),p.setDatas(u,x,P,D,l.get_isReal()),b.setDatas(d,w,a,V,t.get_isReal(),t.get_isConstrained()),w.setDatas(_,b,x,F,t.get_isReal(),t.get_isConstrained()),m.setDatas(d,v,h,T,f.get_isReal()),v.setDatas(c,m,b,V,f.get_isReal()),P.setDatas(d,S,r,D,t.get_isReal(),t.get_isConstrained()),S.setDatas(g,P,m,T,t.get_isReal(),t.get_isConstrained()),F.setDatas(x,l.get_isReal()),V.setDatas(b,f.get_isReal()),T.setDatas(m,f.get_isReal()),D.setDatas(P,l.get_isReal()),_.get_edge()==i&&_.setDatas(w),g.get_edge()==s&&g.setDatas(S),o.set_nextLeftEdge(w),o.set_leftFace(F),a.set_nextLeftEdge(v),a.set_leftFace(V),h.set_nextLeftEdge(S),h.set_leftFace(T),r.set_nextLeftEdge(p),r.set_leftFace(D),i.get_isConstrained()){var O,L,N=i.fromConstraintSegments;w.fromConstraintSegments=N.slice(0),b.fromConstraintSegments=w.fromConstraintSegments,P.fromConstraintSegments=N.slice(0),S.fromConstraintSegments=P.fromConstraintSegments;for(var M=0,j=i.fromConstraintSegments.length;M<j;){var R=M++;-1!=(L=(O=i.fromConstraintSegments[R].get_edges()).indexOf(i))?(O.splice(L,1),O.splice(L,0,w),O.splice(L+1,0,P)):(L=O.indexOf(s),O.splice(L,1),O.splice(L,0,S),O.splice(L+1,0,b))}d.set_fromConstraintSegments(N.slice(0))}return i.dispose(),s.dispose(),this._edges.splice(this._edges.indexOf(i),1),this._edges.splice(this._edges.indexOf(s),1),l.dispose(),f.dispose(),this._faces.splice(this._faces.indexOf(l),1),this._faces.splice(this._faces.indexOf(f),1),this.__centerVertex=d,this.__edgesToCheck.push(o),this.__edgesToCheck.push(a),this.__edgesToCheck.push(h),this.__edgesToCheck.push(r),d},splitFace:function(t,e,n){this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var i=t.get_edge(),s=i.get_nextLeftEdge(),r=s.get_nextLeftEdge(),o=i.get_originVertex(),a=s.get_originVertex(),h=r.get_originVertex(),u=new C,_=new y,c=new y,g=new y,l=new y,f=new y,d=new y,p=new E,x=new E,v=new E;return this._vertices.push(u),this._edges.push(_),this._edges.push(c),this._edges.push(g),this._edges.push(l),this._edges.push(f),this._edges.push(d),this._faces.push(p),this._faces.push(x),this._faces.push(v),u.setDatas(c),u.get_pos().x=e,u.get_pos().y=n,_.setDatas(o,c,d,v),c.setDatas(u,_,i,p),g.setDatas(a,l,c,p),l.setDatas(u,g,s,x),f.setDatas(h,d,l,x),d.setDatas(u,f,r,v),p.setDatas(c),x.setDatas(l),v.setDatas(d),i.set_nextLeftEdge(g),i.set_leftFace(p),s.set_nextLeftEdge(f),s.set_leftFace(x),r.set_nextLeftEdge(_),r.set_leftFace(v),t.dispose(),this._faces.splice(this._faces.indexOf(t),1),this.__centerVertex=u,this.__edgesToCheck.push(i),this.__edgesToCheck.push(s),this.__edgesToCheck.push(r),u},restoreAsDelaunay:function(){for(var t;this.__edgesToCheck.length>0;)!(t=this.__edgesToCheck.shift()).get_isReal()||t.get_isConstrained()||k.isDelaunay(t)||(t.get_nextLeftEdge().get_destinationVertex()==this.__centerVertex?(this.__edgesToCheck.push(t.get_nextRightEdge()),this.__edgesToCheck.push(t.get_prevRightEdge())):(this.__edgesToCheck.push(t.get_nextLeftEdge()),this.__edgesToCheck.push(t.get_prevLeftEdge())),this.flipEdge(t))},deleteVertex:function(t){var e,n,i=new $;i.set_fromVertex(t),i.realEdgesOnly=!1;var s,r=[],o=[],a=!1,h=!1,u=[],_=[];if(e=0==t.get_fromConstraintSegments().length)for(;null!=(n=i.next());)r.push(n),o.push(n.get_nextLeftEdge());else{for(var c,g=0,l=t.get_fromConstraintSegments().length;g<l;){var f=g++;if((c=t.get_fromConstraintSegments()[f].get_edges())[0].get_originVertex()==t||c[c.length-1].get_destinationVertex()==t)return!1}for(var d=0;null!=(n=i.next());)if(r.push(n),n.get_isConstrained()&&++d>2)return!1;u=[],_=[];var p=null,x=null,v=new y,m=new y;this._edges.push(v),this._edges.push(m);for(var E,w=0,b=r.length;w<b;){(n=r[w++]).get_isConstrained()?null==p?(m.setDatas(n.get_destinationVertex(),v,null,null,!0,!0),u.push(v),u.push(n.get_nextLeftEdge()),_.push(m),p=n):null==x&&(v.setDatas(n.get_destinationVertex(),m,null,null,!0,!0),_.push(n.get_nextLeftEdge()),x=n):null==p?_.push(n.get_nextLeftEdge()):null==x?u.push(n.get_nextLeftEdge()):_.push(n.get_nextLeftEdge())}a=p.get_leftFace().get_isReal(),h=x.get_leftFace().get_isReal(),v.fromConstraintSegments=p.fromConstraintSegments.slice(0),m.fromConstraintSegments=v.fromConstraintSegments;for(var C=0,S=t.get_fromConstraintSegments().length;C<S;){var P=C++;if(-1!=(E=(c=t.get_fromConstraintSegments()[P].get_edges()).indexOf(p)))c.splice(E-1,2),c.splice(E-1,0,v);else{var F=c.indexOf(x)-1;c.splice(F,2),c.splice(F,0,m)}}}for(var V=0,T=r.length;V<T;){s=(n=r[V++]).get_leftFace(),this._faces.splice(this._faces.indexOf(s),1),s.dispose(),n.get_destinationVertex().set_edge(n.get_nextLeftEdge()),this._edges.splice(this._edges.indexOf(n.get_oppositeEdge()),1),n.get_oppositeEdge().dispose(),this._edges.splice(this._edges.indexOf(n),1),n.dispose()}return this._vertices.splice(this._vertices.indexOf(t),1),t.dispose(),e?this.triangulate(o,!0):(this.triangulate(u,a),this.triangulate(_,h)),!0},untriangulate:function(t){for(var e,n=new a,i=0,s=t.length;i<s;){var r=i++,o=(e=t[r]).get_originVertex();null==n.h[o.__id__]&&(e.get_originVertex().set_edge(e.get_prevLeftEdge().get_oppositeEdge()),n.set(e.get_originVertex(),!0));var h=e.get_destinationVertex();null==n.h[h.__id__]&&(e.get_destinationVertex().set_edge(e.get_nextLeftEdge()),n.set(e.get_destinationVertex(),!0)),this._faces.splice(this._faces.indexOf(e.get_leftFace()),1),e.get_leftFace().dispose(),r==t.length-1&&(this._faces.splice(this._faces.indexOf(e.get_rightFace()),1),e.get_rightFace().dispose())}for(var u=0,_=t.length;u<_;){e=t[u++],this._edges.splice(this._edges.indexOf(e.get_oppositeEdge()),1),this._edges.splice(this._edges.indexOf(e),1),e.get_oppositeEdge().dispose(),e.dispose()}},triangulate:function(t,e){if(!(t.length<2))if(2!=t.length)if(3==t.length){var n=new E;n.setDatas(t[0],e),this._faces.push(n),t[0].set_leftFace(n),t[1].set_leftFace(n),t[2].set_leftFace(n),t[0].set_nextLeftEdge(t[1]),t[1].set_nextLeftEdge(t[2]),t[2].set_nextLeftEdge(t[0])}else{for(var i,s,r,o=t[0],a=o.get_originVertex(),h=o.get_destinationVertex(),u=new D,_=!1,c=0,g=2,l=t.length;g<l;){var f=g++;if(i=t[f].get_originVertex(),1==k.getRelativePosition2(i.get_pos().x,i.get_pos().y,o)){c=f,_=!0,k.getCircumcenter(a.get_pos().x,a.get_pos().y,h.get_pos().x,h.get_pos().y,i.get_pos().x,i.get_pos().y,u),r=(a.get_pos().x-u.x)*(a.get_pos().x-u.x)+(a.get_pos().y-u.y)*(a.get_pos().y-u.y),r-=1e-4;for(var d=2,p=t.length;d<p;){var x=d++;if(x!=f&&((s=t[x].get_originVertex()).get_pos().x-u.x)*(s.get_pos().x-u.x)+(s.get_pos().y-u.y)*(s.get_pos().y-u.y)<r){_=!1;break}}if(_)break}}if(!_){for(var v=0,m=t.length;v<m;){var w=v++;t[w].get_originVertex().get_pos().x+" , ",t[w].get_originVertex().get_pos().y+" , ",t[w].get_destinationVertex().get_pos().x+" , ",t[w].get_destinationVertex().get_pos().y+" , "}c=2}var b,C,S,P,F=null,V=null,T=null;c<t.length-1&&(F=new y,V=new y,this._edges.push(F),this._edges.push(V),F.setDatas(a,V,null,null,e,!1),V.setDatas(t[c].get_originVertex(),F,null,null,e,!1),(C=t.slice(c)).push(F),this.triangulate(C,e)),c>2&&(T=new y,b=new y,this._edges.push(T),this._edges.push(b),T.setDatas(t[1].get_originVertex(),b,null,null,e,!1),b.setDatas(t[c].get_originVertex(),T,null,null,e,!1),(P=t.slice(1,c)).push(b),this.triangulate(P,e)),S=2==c?[o,t[1],V]:c==t.length-1?[o,T,t[c]]:[o,T,V],this.triangulate(S,e)}else t[0].get_originVertex().get_id(),t[0].get_destinationVertex().get_id(),t[1].get_originVertex().get_id(),t[1].get_destinationVertex().get_id()},findPositionFromBounds:function(t,e){return t<=0?e<=0?1:e>=this._height?7:8:t>=this._width?e<=0?3:e>=this._height?5:4:e<=0?2:e>=this._height?6:0},debug:function(){for(var t=0,e=this._vertices.length;t<e;){var n=t++;this._vertices[n].get_id(),this._vertices[n].get_edge().get_id(),s.string(this._vertices[n].get_edge()),s.string(this._vertices[n].get_edge().get_isReal())}for(var i=0,r=this._edges.length;i<r;){var o=i++;s.string(this._edges[o]),this._edges[o].get_id(),s.string(this._edges[o].get_isReal()),s.string(this._edges[o].get_nextLeftEdge()),s.string(this._edges[o].get_oppositeEdge())}},getVerticesAndEdges:function(){var t,e,n={vertices:[],edges:[]},i=new H;i.set_fromMesh(this);for(var s=new Q,r=new a;null!=(t=i.next());)if(r.set(t,!0),!(t.get_pos().x<0||t.get_pos().x>this.get_width()||t.get_pos().y<0||t.get_pos().y>this.get_height()))for(n.vertices.push(t),s.set_fromVertex(t);null!=(e=s.next());){var o=e.get_originVertex();r.h[o.__id__]||n.edges.push(e)}return n},vertexIsInsideAABB:function(t,e){return!(t.get_pos().x<0||t.get_pos().x>e.get_width()||t.get_pos().y<0||t.get_pos().y>e.get_height())},__class__:w};var b=t.hxDaedalus.data.Object=function(){this._id=b.INC,b.INC++,this._pivotX=0,this._pivotY=0,this._matrix=new O,this._scaleX=1,this._scaleY=1,this._rotation=0,this._x=0,this._y=0,this._coordinates=[],this._hasChanged=!1};b.__name__=!0,b.prototype={get_id:function(){return this._id},dispose:function(){this._matrix=null,this._coordinates=null,this._constraintShape=null},updateValuesFromMatrix:function(){},updateMatrixFromValues:function(){this._matrix.identity(),this._matrix.translate(-this._pivotX,-this._pivotY),this._matrix.scale(this._scaleX,this._scaleY),this._matrix.rotate(this._rotation),this._matrix.translate(this._x,this._y)},get_pivotX:function(){return this._pivotX},set_pivotX:function(t){return this._pivotX=t,this._hasChanged=!0,t},get_pivotY:function(){return this._pivotY},set_pivotY:function(t){return this._pivotY=t,this._hasChanged=!0,t},get_scaleX:function(){return this._scaleX},set_scaleX:function(t){return this._scaleX!=t&&(this._scaleX=t,this._hasChanged=!0),t},get_scaleY:function(){return this._scaleY},set_scaleY:function(t){return this._scaleY!=t&&(this._scaleY=t,this._hasChanged=!0),t},get_rotation:function(){return this._rotation},set_rotation:function(t){return this._rotation!=t&&(this._rotation=t,this._hasChanged=!0),t},get_x:function(){return this._x},set_x:function(t){return this._x!=t&&(this._x=t,this._hasChanged=!0),t},get_y:function(){return this._y},set_y:function(t){return this._y!=t&&(this._y=t,this._hasChanged=!0),t},get_matrix:function(){return this._matrix},set_matrix:function(t){return this._matrix=t,this._hasChanged=!0,t},get_coordinates:function(){return this._coordinates},set_coordinates:function(t){return this._coordinates=t,this._hasChanged=!0,t},get_constraintShape:function(){return this._constraintShape},set_constraintShape:function(t){return this._constraintShape=t,this._hasChanged=!0,t},get_hasChanged:function(){return this._hasChanged},set_hasChanged:function(t){return this._hasChanged=t,t},get_edges:function(){for(var t=[],e=this._constraintShape.segments,n=0,i=e.length;n<i;)for(var s=n++,r=0,o=e[s].get_edges().length;r<o;){var a=r++;t.push(e[s].get_edges()[a])}return t},__class__:b};var C=t.hxDaedalus.data.Vertex=function(){this.colorDebug=-1,this._id=C.INC,C.INC++,this._pos=new D,this._fromConstraintSegments=[]};C.__name__=!0,C.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},get_pos:function(){return this._pos},get_fromConstraintSegments:function(){return this._fromConstraintSegments},set_fromConstraintSegments:function(t){return this._fromConstraintSegments=t},setDatas:function(t,e){null==e&&(e=!0),this._isReal=e,this._edge=t},addFromConstraintSegment:function(t){-1==this._fromConstraintSegments.indexOf(t)&&this._fromConstraintSegments.push(t)},removeFromConstraintSegment:function(t){var e=this._fromConstraintSegments.indexOf(t);-1!=e&&this._fromConstraintSegments.splice(e,1)},dispose:function(){this._pos=null,this._edge=null,this._fromConstraintSegments=null},get_edge:function(){return this._edge},set_edge:function(t){return this._edge=t},toString:function(){return"ver_id "+this._id},__class__:C};var S=t.hxDaedalus.data.graph.Graph=function(){this._id=S.INC,S.INC++};S.__name__=!0,S.prototype={get_id:function(){return this._id},get_edge:function(){return this._edge},get_node:function(){return this._node},dispose:function(){for(;null!=this._node;)this.deleteNode(this._node)},insertNode:function(){var t=new F;return null!=this._node&&(t.set_next(this._node),this._node.set_prev(t)),this._node=t,t},deleteNode:function(t){for(;null!=t.get_outgoingEdge();)null!=t.get_outgoingEdge().get_oppositeEdge()&&this.deleteEdge(t.get_outgoingEdge().get_oppositeEdge()),this.deleteEdge(t.get_outgoingEdge());for(var e,n=this._node;null!=n;)null!=(e=n.get_successorNodes().h[t.__id__])&&this.deleteEdge(e),n=n.get_next();this._node==t?null!=t.get_next()?(t.get_next().set_prev(null),this._node=t.get_next()):this._node=null:null!=t.get_next()?(t.get_prev().set_next(t.get_next()),t.get_next().set_prev(t.get_prev())):t.get_prev().set_next(null),t.dispose()},insertEdge:function(t,e){if(null!=t.get_successorNodes().h[e.__id__])return null;var n=new P;null!=this._edge&&(this._edge.set_prev(n),n.set_next(this._edge)),this._edge=n,n.set_sourceNode(t),n.set_destinationNode(e),t.get_successorNodes().set(e,n),null!=t.get_outgoingEdge()?(t.get_outgoingEdge().set_rotPrevEdge(n),n.set_rotNextEdge(t.get_outgoingEdge()),t.set_outgoingEdge(n)):t.set_outgoingEdge(n);var i=e.get_successorNodes().h[t.__id__];return null!=i&&(n.set_oppositeEdge(i),i.set_oppositeEdge(n)),n},deleteEdge:function(t){this._edge==t?null!=t.get_next()?(t.get_next().set_prev(null),this._edge=t.get_next()):this._edge=null:null!=t.get_next()?(t.get_prev().set_next(t.get_next()),t.get_next().set_prev(t.get_prev())):t.get_prev().set_next(null),t.get_sourceNode().get_outgoingEdge()==t?null!=t.get_rotNextEdge()?(t.get_rotNextEdge().set_rotPrevEdge(null),t.get_sourceNode().set_outgoingEdge(t.get_rotNextEdge())):t.get_sourceNode().set_outgoingEdge(null):null!=t.get_rotNextEdge()?(t.get_rotPrevEdge().set_rotNextEdge(t.get_rotNextEdge()),t.get_rotNextEdge().set_rotPrevEdge(t.get_rotPrevEdge())):t.get_rotPrevEdge().set_rotNextEdge(null),t.dispose()},__class__:S};var P=t.hxDaedalus.data.graph.GraphEdge=function(){this._id=P.INC,P.INC++};P.__name__=!0,P.prototype={get_id:function(){return this._id},dispose:function(){},get_prev:function(){return this._prev},set_prev:function(t){return this._prev=t,t},get_next:function(){return this._next},set_next:function(t){return this._next=t,t},get_rotPrevEdge:function(){return this._rotPrevEdge},set_rotPrevEdge:function(t){return this._rotPrevEdge=t,t},get_rotNextEdge:function(){return this._rotNextEdge},set_rotNextEdge:function(t){return this._rotNextEdge=t,t},get_oppositeEdge:function(){return this._oppositeEdge},set_oppositeEdge:function(t){return this._oppositeEdge=t,t},get_sourceNode:function(){return this._sourceNode},set_sourceNode:function(t){return this._sourceNode=t,t},get_destinationNode:function(){return this._destinationNode},set_destinationNode:function(t){return this._destinationNode=t,t},get_data:function(){return this._data},set_data:function(t){return this._data=t,t},__class__:P};var F=t.hxDaedalus.data.graph.GraphNode=function(){this._id=F.INC,F.INC++,this._successorNodes=new a};F.__name__=!0,F.prototype={get_id:function(){return this._id},dispose:function(){this._prev=null,this._next=null,this._outgoingEdge=null,this._successorNodes=null,this._data=null},get_prev:function(){return this._prev},set_prev:function(t){return this._prev=t,t},get_next:function(){return this._next},set_next:function(t){return this._next=t,t},get_outgoingEdge:function(){return this._outgoingEdge},set_outgoingEdge:function(t){return this._outgoingEdge=t,t},get_successorNodes:function(){return this._successorNodes},set_successorNodes:function(t){return this._successorNodes=t,t},get_data:function(){return this._data},set_data:function(t){return this._data=t,t},__class__:F};var V=t.hxDaedalus.data.math.EdgeData=function(){};V.__name__=!0,V.prototype={__class__:V};var T={__ename__:!0,__constructs__:["EVertex","EEdge","EFace","ENull"],EVertex:function(t){var e=["EVertex",0,t];return e.__enum__=T,e.toString=n,e},EEdge:function(t){var e=["EEdge",1,t];return e.__enum__=T,e.toString=n,e},EFace:function(t){var e=["EFace",2,t];return e.__enum__=T,e.toString=n,e},ENull:["ENull",3]};T.ENull.toString=n,T.ENull.__enum__=T;var D=t.hxDaedalus.data.math.Point2D=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};D.__name__=!0,D.prototype={transform:function(t){t.tranform(this)},setXY:function(t,e){this.x=t,this.y=e},clone:function(){return new D(this.x,this.y)},substract:function(t){this.x-=t.x,this.y-=t.y},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var t=this.get_length();this.x/=t,this.y/=t},scale:function(t){this.x*=t,this.y*=t},distanceTo:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},__class__:D};var k=t.hxDaedalus.data.math.Geom2D=function(){};k.__name__=!0,k.locatePosition=function(t,e,n){null==k._randGen&&(k._randGen=new M),k._randGen.set_seed(10*t+4*e|0),k.__samples.splice(0,k.__samples.length);var i=0|Math.pow(n._vertices.length,.3333333333333333);k._randGen.rangeMin=0,k._randGen.rangeMax=n._vertices.length-1;for(var s,r,o,h=0,u=i;h<u;){h++;var _=k._randGen.next();_<0||n._vertices.length,n._vertices,n._vertices.length;k.__samples.push(n._vertices[_])}for(var c,g=1/0,l=null,f=0,d=i;f<d;){var p=f++;(o=((r=(s=k.__samples[p]).get_pos()).x-t)*(r.x-t)+(r.y-e)*(r.y-e))<g&&(g=o,l=s)}var x=new U;x.set_fromVertex(l),c=x.next();for(var v,m,y=new a,E=new X,w=T.ENull,b=0;;){var C;if(y.h[c.__id__])C=!0;else C=3==(w=k.isInFace(t,e,c))[1];if(!C)break;++b;for(E.set_fromFace(c);;){if(null==(v=E.next()))return T.ENull;if(1!=(m=k.getRelativePosition(t,e,v))&&0!=m)break}c=v.get_rightFace()}return w},k.isCircleIntersectingAnyConstraint=function(t,e,n,i){if(t<=0||t>=i.get_width()||e<=0||e>=i.get_height())return!0;var s,r=k.locatePosition(t,e,i);switch(r[1]){case 0:s=r[2].get_edge().get_leftFace();break;case 1:s=r[2].get_leftFace();break;case 2:s=r[2];break;case 3:s=null}var o,h=n*n;if(((o=s.get_edge().get_originVertex().get_pos()).x-t)*(o.x-t)+(o.y-e)*(o.y-e)<=h)return!0;if(((o=s.get_edge().get_nextLeftEdge().get_originVertex().get_pos()).x-t)*(o.x-t)+(o.y-e)*(o.y-e)<=h)return!0;if(((o=s.get_edge().get_nextLeftEdge().get_nextLeftEdge().get_originVertex().get_pos()).x-t)*(o.x-t)+(o.y-e)*(o.y-e)<=h)return!0;var u,_,c,g=[];g.push(s.get_edge()),g.push(s.get_edge().get_nextLeftEdge()),g.push(s.get_edge().get_nextLeftEdge().get_nextLeftEdge());for(var l=new a;g.length>0;)if(u=g.pop(),l.set(u,!0),_=u.get_originVertex().get_pos(),c=u.get_destinationVertex().get_pos(),k.intersectionsSegmentCircle(_.x,_.y,c.x,c.y,t,e,n)){if(u.get_isConstrained())return!0;var f,d;if(u=u.get_oppositeEdge().get_nextLeftEdge(),l.h[u.__id__])f=!1;else{var p=u.get_oppositeEdge();f=!l.h[p.__id__]}if(!!(!!f&&-1==g.indexOf(u))&&-1==g.indexOf(u.get_oppositeEdge())&&g.push(u),u=u.get_nextLeftEdge(),l.h[u.__id__])d=!1;else{var x=u.get_oppositeEdge();d=!l.h[x.__id__]}!!(!!d&&-1==g.indexOf(u))&&-1==g.indexOf(u.get_oppositeEdge())&&g.push(u)}return!1},k.getDirection=function(t,e,n,i,s,r){var o=(s-t)*(i-e)+(r-e)*(-n+t);return 0==o?0:o>0?1:-1},k.getDirection2=function(t,e,n,i,s,r){var o=(s-t)*(i-e)+(r-e)*(-n+t);return 0==o?0:o>0?k.distanceSquaredPointToLine(s,r,t,e,n,i)<=1e-4?0:1:k.distanceSquaredPointToLine(s,r,t,e,n,i)<=1e-4?0:-1},k.getRelativePosition=function(t,e,n){return k.getDirection(n.get_originVertex().get_pos().x,n.get_originVertex().get_pos().y,n.get_destinationVertex().get_pos().x,n.get_destinationVertex().get_pos().y,t,e)},k.getRelativePosition2=function(t,e,n){return k.getDirection2(n.get_originVertex().get_pos().x,n.get_originVertex().get_pos().y,n.get_destinationVertex().get_pos().x,n.get_destinationVertex().get_pos().y,t,e)},k.isInFace=function(t,e,n){var i=T.ENull,s=n.get_edge(),r=s.get_nextLeftEdge(),o=r.get_nextLeftEdge();if(k.getRelativePosition(t,e,s)>=0&&k.getRelativePosition(t,e,r)>=0&&k.getRelativePosition(t,e,o)>=0){var a=s.get_originVertex(),h=r.get_originVertex(),u=o.get_originVertex(),_=a.get_pos().x,c=a.get_pos().y,g=h.get_pos().x,l=h.get_pos().y,f=u.get_pos().x,d=u.get_pos().y,p=(t-_)*(g-_)+(e-c)*(l-c),x=(t-g)*(f-g)+(e-l)*(d-l),v=(t-f)*(_-f)+(e-d)*(c-d),m=(g-t)*(g-t)+(l-e)*(l-e)-x*x/((f-g)*(f-g)+(d-l)*(d-l))<=1e-4,y=(f-t)*(f-t)+(d-e)*(d-e)-v*v/((_-f)*(_-f)+(c-d)*(c-d))<=1e-4;i=(_-t)*(_-t)+(c-e)*(c-e)-p*p/((g-_)*(g-_)+(l-c)*(l-c))<=1e-4?y?T.EVertex(a):m?T.EVertex(h):T.EEdge(s):m?y?T.EVertex(u):T.EEdge(r):y?T.EEdge(o):T.EFace(n)}return i},k.clipSegmentByTriangle=function(t,e,n,i,s,r,o,a,h,u,_,c){var g,l,f,d,p,x;if(g=k.getDirection(s,r,o,a,t,e),l=k.getDirection(s,r,o,a,n,i),g<=0&&l<=0)return!1;if(f=k.getDirection(o,a,h,u,t,e),d=k.getDirection(o,a,h,u,n,i),f<=0&&d<=0)return!1;if(p=k.getDirection(h,u,s,r,t,e),x=k.getDirection(h,u,s,r,n,i),p<=0&&x<=0)return!1;if(g>=0&&f>=0&&p>=0&&l>=0&&d>=0&&x>=0)return _.x=t,_.y=e,c.x=n,c.y=i,!0;var v=0;return k.intersections2segments(t,e,n,i,s,r,o,a,_,null)&&++v,0==v?k.intersections2segments(t,e,n,i,o,a,h,u,_,null)&&++v:k.intersections2segments(t,e,n,i,o,a,h,u,c,null)&&(-.01>_.x-c.x||_.x-c.x>.01||-.01>_.y-c.y||_.y-c.y>.01)&&++v,0==v?k.intersections2segments(t,e,n,i,h,u,s,r,_,null)&&++v:1==v&&k.intersections2segments(t,e,n,i,h,u,s,r,c,null)&&(-.01>_.x-c.x||_.x-c.x>.01||-.01>_.y-c.y||_.y-c.y>.01)&&++v,1==v&&(g>=0&&f>=0&&p>=0?(c.x=t,c.y=e):l>=0&&d>=0&&x>=0?(c.x=n,c.y=i):v=0),v>0},k.isSegmentIntersectingTriangle=function(t,e,n,i,s,r,o,a,h,u){var _,c,g,l,f,d,p,x;return _=k.getDirection(s,r,o,a,t,e),c=k.getDirection(s,r,o,a,n,i),!(_<=0&&c<=0)&&(g=k.getDirection(o,a,h,u,t,e),l=k.getDirection(o,a,h,u,n,i),!(g<=0&&l<=0)&&(f=k.getDirection(h,u,s,r,t,e),d=k.getDirection(h,u,s,r,n,i),!(f<=0&&d<=0)&&(1==_&&1==g&&1==f||(1==_&&1==g&&1==f||((1==_&&c<=0||_<=0&&1==c)&&(p=k.getDirection(t,e,n,i,s,r),x=k.getDirection(t,e,n,i,o,a),1==p&&x<=0||p<=0&&1==x)||((1==g&&l<=0||g<=0&&1==l)&&(p=k.getDirection(t,e,n,i,o,a),x=k.getDirection(t,e,n,i,h,u),1==p&&x<=0||p<=0&&1==x)||(1==f&&d<=0||f<=0&&1==d)&&(p=k.getDirection(t,e,n,i,h,u),x=k.getDirection(t,e,n,i,s,r),1==p&&x<=0||p<=0&&1==x)))))))},k.isDelaunay=function(t){var e=t.get_originVertex(),n=t.get_destinationVertex(),i=t.get_nextLeftEdge().get_destinationVertex(),s=t.get_nextRightEdge().get_destinationVertex();k.getCircumcenter(i.get_pos().x,i.get_pos().y,e.get_pos().x,e.get_pos().y,n.get_pos().x,n.get_pos().y,k.__circumcenter);var r=(i.get_pos().x-k.__circumcenter.x)*(i.get_pos().x-k.__circumcenter.x)+(i.get_pos().y-k.__circumcenter.y)*(i.get_pos().y-k.__circumcenter.y);return(s.get_pos().x-k.__circumcenter.x)*(s.get_pos().x-k.__circumcenter.x)+(s.get_pos().y-k.__circumcenter.y)*(s.get_pos().y-k.__circumcenter.y)>=r},k.getCircumcenter=function(t,e,n,i,s,r,o){null==o&&(o=new D);var a=(t+n)/2,h=(e+i)/2,u=(a*(t-s)+(h-(e+r)/2)*(e-r)+(t+s)/2*(s-t))/(t*(r-i)+n*(e-r)+s*(i-e));return o.x=a+u*(i-e),o.y=h-u*(n-t),o},k.intersections2segments=function(t,e,n,i,s,r,o,a,h,u,_){null==_&&(_=!1);var c,g=0,l=0,f=(t-n)*(r-a)+(i-e)*(s-o);return 0==f?c=!1:(c=!0,_&&null==h&&null==u||(g=(t*(r-a)+e*(o-s)+s*a-r*o)/f,l=(t*(r-i)+e*(n-s)-n*r+i*s)/f,_||0<=g&&g<=1&&0<=l&&l<=1||(c=!1))),c&&(null!=h&&(h.x=t+g*(n-t),h.y=e+g*(i-e)),null!=u&&(u.push(g),u.push(l))),c},k.intersections2edges=function(t,e,n,i,s){return null==s&&(s=!1),k.intersections2segments(t.get_originVertex().get_pos().x,t.get_originVertex().get_pos().y,t.get_destinationVertex().get_pos().x,t.get_destinationVertex().get_pos().y,e.get_originVertex().get_pos().x,e.get_originVertex().get_pos().y,e.get_destinationVertex().get_pos().x,e.get_destinationVertex().get_pos().y,n,i,s)},k.isConvex=function(t){var e,n,i=!0;return e=t.get_nextLeftEdge().get_oppositeEdge(),n=t.get_nextRightEdge().get_destinationVertex(),-1!=k.getRelativePosition(n.get_pos().x,n.get_pos().y,e)?i=!1:(e=t.get_prevRightEdge(),n=t.get_prevLeftEdge().get_originVertex(),-1!=k.getRelativePosition(n.get_pos().x,n.get_pos().y,e)&&(i=!1)),i},k.projectOrthogonaly=function(t,e){var n=e.get_originVertex().get_pos().x,i=e.get_originVertex().get_pos().y,s=e.get_destinationVertex().get_pos().x,r=e.get_destinationVertex().get_pos().y,o=t.x,a=t.y,h=(n*n-n*s-n*o+i*i-i*r-i*a+s*o+r*a)/(n*n-2*n*s+i*i-2*i*r+s*s+r*r);t.x=n+h*(s-n),t.y=i+h*(r-i)},k.intersections2Circles=function(t,e,n,i,s,r,o){var a=(i-t)*(i-t)+(s-e)*(s-e);if((t!=i||e!=s)&&a<=(n+r)*(n+r)&&a>=(n-r)*(n-r)){var h=Math.sqrt(((n+r)*(n+r)-a)*(a-(r-n)*(r-n))),u=(t+i)/2+(i-t)*(n*n-r*r)/(2*a),_=(e+s)/2+(s-e)*(n*n-r*r)/(2*a),c=(s-e)/(2*a),g=(i-t)/(2*a);if(null!=o)for(var l=0,f=[u+c*h,_-g*h,u-c*h,_+g*h];l<f.length;){var d=f[l];++l,o.push(d)}return!0}return!1},k.intersectionsSegmentCircle=function(t,e,n,i,s,r,o,a){var h,u,_,c=t*t,g=e*e,l=i*i-2*i*e+g+n*n-2*n*t+c,f=2*e*r-2*c+2*i*e-2*g+2*n*t-2*n*s+2*t*s-2*i*r,d=f*f-4*l*(g+r*r+s*s-2*e*r-2*t*s+c-o*o);if(d<0)return!1;if(0==d){if((u=-f/(2*l))<0||u>1)return!1;if(null!=a)for(var p=0,x=[t+u*(n-t),e+u*(i-e),u];p<x.length;){var v=x[p];++p,a.push(v)}return!0}_=(-f-(h=Math.sqrt(d)))/(2*l);var m=!1;if(0<=(u=(-f+h)/(2*l))&&u<=1){if(null!=a)for(var y=0,E=[t+u*(n-t),e+u*(i-e),u];y<E.length;){var w=E[y];++y,a.push(w)}m=!0}if(0<=_&&_<=1){if(null!=a)for(var b=0,C=[t+_*(n-t),e+_*(i-e),_];b<C.length;){var S=C[b];++b,a.push(S)}m=!0}return m},k.intersectionsLineCircle=function(t,e,n,i,s,r,o,a){var h,u,_,c=t*t,g=e*e,l=i*i-2*i*e+g+n*n-2*n*t+c,f=2*e*r-2*c+2*i*e-2*g+2*n*t-2*n*s+2*t*s-2*i*r,d=f*f-4*l*(g+r*r+s*s-2*e*r-2*t*s+c-o*o);if(d<0)return!1;if(0==d)for(var p=0,x=[t+(u=-f/(2*l))*(n-t),e+u*(i-e),u];p<x.length;){var v=x[p];++p,a.push(v)}else if(d>0)for(var m=0,y=[t+(u=(-f+(h=Math.sqrt(d)))/(2*l))*(n-t),e+u*(i-e),u,t+(_=(-f-h)/(2*l))*(n-t),e+_*(i-e),_];m<y.length;){var E=y[m];++m,a.push(E)}return!0},k.tangentsPointToCircle=function(t,e,n,i,s,r){var o=(t+n)/2,a=(e+i)/2,h=.5*Math.sqrt((t-n)*(t-n)+(e-i)*(e-i));return k.intersections2Circles(o,a,h,n,i,s,r)},k.tangentsCrossCircleToCircle=function(t,e,n,i,s,r){var o=Math.sqrt((e-i)*(e-i)+(n-s)*(n-s)),a=o/4,h=e+(i-e)/4,u=n+(s-n)/4;if(k.intersections2Circles(e,n,t,h,u,a,r)){for(var _=r[0],c=r[1],g=(e+i)/2,l=(n+s)/2,f=((_-g)*(s-n)+(c-l)*(-i+e))/(o*o),d=2*(g+f*(s-n))-_,p=2*(l-f*(i-e))-c,x=0,v=[d+r[2]-_,r[3]+p-c,d,p];x<v.length;){var m=v[x];++x,r.push(m)}return!0}return!1},k.tangentsParalCircleToCircle=function(t,e,n,i,s,r){for(var o=Math.sqrt((e-i)*(e-i)+(n-s)*(n-s)),a=e+t*(s-n)/o,h=n+t*(-i+e)/o,u=2*e-a,_=2*n-h,c=0,g=[a,h,u,_,u+i-e,_+s-n,a+i-e,h+s-n];c<g.length;){var l=g[c];++c,r.push(l)}},k.distanceSquaredPointToLine=function(t,e,n,i,s,r){var o=(t-n)*(s-n)+(e-i)*(r-i);return(n-t)*(n-t)+(i-e)*(i-e)-o*o/((s-n)*(s-n)+(r-i)*(r-i))},k.distanceSquaredPointToSegment=function(t,e,n,i,s,r){var o=(s-n)*(s-n)+(r-i)*(r-i),a=((t-n)*(s-n)+(e-i)*(r-i))/o;return a<0?(t-n)*(t-n)+(e-i)*(e-i):a<=1?(n-t)*(n-t)+(i-e)*(i-e)-a*a*o:(t-s)*(t-s)+(e-r)*(e-r)},k.distanceSquaredVertexToEdge=function(t,e){return k.distanceSquaredPointToSegment(t.get_pos().x,t.get_pos().y,e.get_originVertex().get_pos().x,e.get_originVertex().get_pos().y,e.get_destinationVertex().get_pos().x,e.get_destinationVertex().get_pos().y)},k.pathLength=function(t){for(var e,n,i,s,r=0,o=t[0],a=t[1],h=2;h<t.length;)i=(e=t[h])-o,s=(n=t[h+1])-a,r+=Math.sqrt(i*i+s*s),o=e,a=n,h+=2;return r},k.prototype={__class__:k};var O=t.hxDaedalus.data.math.Matrix2D=function(t,e,n,i,s,r){null==r&&(r=0),null==s&&(s=0),null==i&&(i=1),null==n&&(n=0),null==e&&(e=0),null==t&&(t=1),this.a=t,this.b=e,this.c=n,this.d=i,this.e=s,this.f=r};O.__name__=!0,O.prototype={identity:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0},translate:function(t,e){this.e+=t,this.f+=e},scale:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a*e+this.b*-n,s=this.a*n+this.b*e,r=this.c*e+this.d*-n,o=this.c*n+this.d*e,a=this.e*e+this.f*-n,h=this.e*n+this.f*e;this.a=i,this.b=s,this.c=r,this.d=o,this.e=a,this.f=h},clone:function(){return new O(this.a,this.b,this.c,this.d,this.e,this.f)},tranform:function(t){var e=this.a*t.x+this.c*t.y+this.e,n=this.b*t.x+this.d*t.y+this.f;t.x=e,t.y=n},transformX:function(t,e){return this.a*t+this.c*e+this.e},transformY:function(t,e){return this.b*t+this.d*e+this.f},concat:function(t){var e=this.a*t.a+this.b*t.c,n=this.a*t.b+this.b*t.d,i=this.c*t.a+this.d*t.c,s=this.c*t.b+this.d*t.d,r=this.e*t.a+this.f*t.c+t.e,o=this.e*t.b+this.f*t.d+t.f;this.a=e,this.b=n,this.c=i,this.d=s,this.e=r,this.f=o},__class__:O};var L=t.hxDaedalus.data.math.NodeData=function(){};L.__name__=!0,L.prototype={__class__:L};var N=t.hxDaedalus.data.math.Potrace=function(){};N.__name__=!0,N.buildShapes=function(t,e,n){for(var i=[],s=new h,r=1,o=t.height-1;r<o;)for(var a=r++,u=0,_=t.width-1;u<_;){var c=u++;if(16777215==Z.getPixel(t,c,a)&&Z.getPixel(t,c+1,a)<16777215){var g=c+1+"_"+a;(null!=Et[g]?s.getReserved(g):s.h[g])||i.push(N.buildShape(t,a,c+1,s,e,n))}}return i},N.buildShape=function(t,e,n,i,s,r){var o=n,a=e,h=[o,a],u=o+"_"+a;null!=Et[u]?i.setReserved(u,!0):i.h[u]=!0;for(var _,c,g=new D(0,1),l=new D,f=-1;null!=s&&Z.setPixel32(s,n,e,-65536),_=e+g.x+g.y|0,c=n+g.x-g.y|0,Z.getPixel(t,c,_)<16777215?(l.x=-g.y,l.y=g.x):(_=e+g.y|0,c=n+g.x|0,Z.getPixel(t,c,_)<16777215?(l.x=g.x,l.y=g.y):(_=e,c=n,l.x=g.y,l.y=-g.x)),o+=g.x,a+=g.y,o!=h[0]||a!=h[1];){h.push(o),h.push(a);var d=o+"_"+a;if(null!=Et[d]?i.setReserved(d,!0):i.h[d]=!0,e=_,n=c,g.x=l.x,g.y=l.y,0==--f)break}if(null!=r){r.graphics.lineStyle(.5,65280,1),r.graphics.moveTo(h[0],h[1]);for(var p=2;p<h.length;)r.graphics.lineTo(h[p],h[p+1]),p+=2;r.graphics.lineTo(h[0],h[1])}return h},N.buildGraph=function(t){var e,n,i,s,r,o,a,h,u,_,c,g=new S;for(e=0;e<t.length;){(n=g.insertNode()).set_data(new L),n.get_data().index=e;var l=t[e],f=t[e+1];n.get_data().point=new D(l,f),e+=2}for(i=g.get_node();null!=i;){for(s=null!=i.get_next()?i.get_next():g.get_node();s!=i;){for(u=!0,r=null!=i.get_next()?i.get_next():g.get_node(),h=2,a=0;r!=s;){if((o=k.distanceSquaredPointToSegment(r.get_data().point.x,r.get_data().point.y,i.get_data().point.x,i.get_data().point.y,s.get_data().point.x,s.get_data().point.y))<0&&(o=0),o>=N.maxDistance){u=!1;break}++h,a+=o,r=null!=r.get_next()?r.get_next():g.get_node()}if(!u)break;_=g.insertEdge(i,s),(c=new V).sumDistancesSquared=a,c.length=i.get_data().point.distanceTo(s.get_data().point),c.nodesCount=h,_.set_data(c),s=null!=s.get_next()?s.get_next():g.get_node()}i=i.get_next()}return g},N.buildPolygon=function(t,e){var n,i,s,r,o=[],a=2147483647,h=null;for(n=t.get_node();n.get_data().index<a;){for(a=n.get_data().index,o.push(n.get_data().point.x),o.push(n.get_data().point.y),r=0,i=n.get_outgoingEdge();null!=i;)(s=i.get_data().nodesCount-i.get_data().length*Math.sqrt(i.get_data().sumDistancesSquared/i.get_data().nodesCount))>r&&(r=s,h=i),i=i.get_rotNextEdge();n=h.get_destinationNode()}if(0==k.getDirection(o[o.length-2],o[o.length-1],o[0],o[1],o[2],o[3])&&(o.shift(),o.shift()),null!=e){e.graphics.lineStyle(.5,255),e.graphics.moveTo(o[0],o[1]);for(var u=2;u<o.length;)e.graphics.lineTo(o[u],o[u+1]),u+=2;e.graphics.lineTo(o[0],o[1])}return o},N.prototype={__class__:N};var M=t.hxDaedalus.data.math.RandGenerator=function(t,e,n){null==n&&(n=1),null==e&&(e=0),null==t&&(t=1234),this._originalSeed=this._currSeed=t,this.rangeMin=e,this.rangeMax=n,this._numIter=0};M.__name__=!0,M.prototype={set_seed:function(t){return this._originalSeed=this._currSeed=t,t},get_seed:function(){return this._originalSeed},reset:function(){this._currSeed=this._originalSeed,this._numIter=0},next:function(){var t=1*this._currSeed;for(this._tempString=s.string(t*t);this._tempString.length<8;)this._tempString="0"+this._tempString;this._currSeed=s.parseInt(i.substr(this._tempString,1,5));var e=Math.round(this.rangeMin+this._currSeed/99999*(this.rangeMax-this.rangeMin));return 0==this._currSeed&&(this._currSeed=this._originalSeed+this._numIter),this._numIter++,200==this._numIter&&this.reset(),e},nextInRange:function(t,e){return this.rangeMin=t,this.rangeMax=e,this.next()},shuffle:function(t){for(var e=t.length;e>0;){var n=this.nextInRange(0,e-1),i=t[--e];t[e]=t[n],t[n]=i}},__class__:M};var j=t.hxDaedalus.data.math.ShapeSimplifier=function(){};j.__name__=!0,j.simplify=function(t,e){null==e&&(e=1);var n=t.length;if(n<=4||e<1)return[].concat(t);for(var i=t[0],s=t[1],r=t[n-2],o=t[n-1],a=-1,h=0,u=1,_=n>>1;u<_;){var c=u++,g=k.distanceSquaredPointToSegment(t[c<<1],t[1+(c<<1)],i,s,r,o);g>h&&(h=g,a=c)}if(h>e*e){var l=t.slice(0,2+(a<<1)),f=t.slice(a<<1),d=j.simplify(l,e),p=j.simplify(f,e);return d.slice(0,d.length-2).concat(p)}return[i,s,r,o]};var R=t.hxDaedalus.data.math.Tools=function(){};R.__name__=!0,R.extractMeshFromBitmap=function(t,e,n){var i=N.buildShapes(t);return R.extractMeshFromShapes(i,t.width,t.height,e,n)},R.extractMeshFromShapes=function(t,e,n,i,s,r){null==r&&(r=!1);for(var o=[],h=0,u=t.length;h<u;){var _=h++;o.push(N.buildGraph(t[_]))}for(var c=[],g=0,l=o.length;g<l;){var f=g++;c.push(N.buildPolygon(o[f]))}for(var d,p=q.buildRectangle(e,n),x=[],v=0,m=c.length;v<m;){for(var y=v++,E=0;E<c[y].length-2;)d=p.insertConstraintSegment(c[y][E],c[y][E+1],c[y][E+2],c[y][E+3]),0==E&&(d.get_edges()[0].get_originVertex().get_pos().x==c[y][E]&&d.get_edges()[0].get_originVertex().get_pos().y==c[y][E+1]?r?x.push(d.get_edges()[0].get_oppositeEdge()):x.push(d.get_edges()[0]):r?x.push(d.get_edges()[0]):x.push(d.get_edges()[0].get_oppositeEdge())),E+=2;p.insertConstraintSegment(c[y][0],c[y][1],c[y][E],c[y][E+1])}for(var w,b,C=new a,S=0,P=p._vertices.length;S<P;){var F=S++;if((w=p._vertices[F]).get_isReal()&&w.get_pos().x>0&&w.get_pos().x<e&&w.get_pos().y>0&&w.get_pos().y<n){b=new D(w.get_pos().x,w.get_pos().y),i.push(b);var V=i.length-1;C.set(w,V)}}for(var T,k=new a,O=[],L=0,M=x.length;L<M;){var j=L++;O.push(x[j].get_rightFace())}for(;O.length>0;)if(T=O.pop(),!k.h[T.__id__]){var R=T.get_edge().get_originVertex();s.push(C.h[R.__id__]);var I=T.get_edge().get_nextLeftEdge().get_originVertex();s.push(C.h[I.__id__]);var A=T.get_edge().get_nextLeftEdge().get_destinationVertex();s.push(C.h[A.__id__]),T.get_edge().get_isConstrained()||O.push(T.get_edge().get_rightFace()),T.get_edge().get_nextLeftEdge().get_isConstrained()||O.push(T.get_edge().get_nextLeftEdge().get_rightFace()),T.get_edge().get_prevLeftEdge().get_isConstrained()||O.push(T.get_edge().get_prevLeftEdge().get_rightFace()),k.set(T,!0)}return p};var I=function(){};I.__name__=!0,I.assertTrue=function(t,e,n){},I.assertFalse=function(t,e,n){},I.assertEquals=function(t,e,n,i){},I.trace=function(t,e){};var A=t.hxDaedalus.factories.BitmapMesh=function(){};A.__name__=!0,A.buildFromBmpData=function(t,e,n){for(var i,s=N.buildShapes(t,e,n),r=[],o=0,a=s.length;o<a;){var h=o++;r.push(N.buildGraph(s[h]))}for(var u=[],_=0,c=r.length;_<c;){var g=_++;u.push(N.buildPolygon(r[g],n))}for(var l=q.buildRectangle(t.width,t.height),f=0,d=u.length;f<d;){var p=f++;for(i=0;i<u[p].length-2;)l.insertConstraintSegment(u[p][i],u[p][i+1],u[p][i+2],u[p][i+3]),i+=2;l.insertConstraintSegment(u[p][0],u[p][1],u[p][i],u[p][i+1])}return l},A.prototype={__class__:A};var B=t.hxDaedalus.factories.BitmapObject=function(){};B.__name__=!0,B.buildFromBmpData=function(t,e,n,i){var s;null==e&&(e=1);t.width>0&&t.height,t.width,t.height;var r=N.buildShapes(t,n,i);if(e>=1)for(var o=0,a=r.length;o<a;){var h=o++;r[h]=j.simplify(r[h],e)}for(var u=[],_=0,c=r.length;_<c;){var g=_++;u.push(N.buildGraph(r[g]))}for(var l=[],f=0,d=u.length;f<d;){var p=f++;l.push(N.buildPolygon(u[p],i))}for(var x=new b,v=0,m=l.length;v<m;){var y=v++;for(s=0;s<l[y].length-2;)x.get_coordinates().push(l[y][s]),x.get_coordinates().push(l[y][s+1]),x.get_coordinates().push(l[y][s+2]),x.get_coordinates().push(l[y][s+3]),s+=2;x.get_coordinates().push(l[y][0]),x.get_coordinates().push(l[y][1]),x.get_coordinates().push(l[y][s]),x.get_coordinates().push(l[y][s+1])}return x},B.prototype={__class__:B};var q=t.hxDaedalus.factories.RectMesh=function(){};q.__name__=!0,q.buildRectangle=function(t,e){var n=new C,i=new C,s=new C,r=new C,o=new y,a=new y,h=new y,u=new y,_=new y,c=new y,g=new y,l=new y,f=new y,d=new y,p=new y,x=new y,b=new E,S=new E,P=new E,F=new E,V=new m,T=new v,D=new v,k=new v,O=new v,L=new w(t,e);n.get_pos().setXY(-10,-10),i.get_pos().setXY(t+10,-10),s.get_pos().setXY(t+10,e+10),r.get_pos().setXY(-10,e+10),n.setDatas(o),i.setDatas(h),s.setDatas(_),r.setDatas(g),o.setDatas(n,a,h,F,!0,!0),a.setDatas(i,o,l,b,!0,!0),h.setDatas(i,u,x,F,!0,!0),u.setDatas(s,h,f,S,!0,!0),_.setDatas(s,c,g,P,!0,!0),c.setDatas(r,_,u,S,!0,!0),g.setDatas(r,l,p,P,!0,!0),l.setDatas(n,g,d,b,!0,!0),f.setDatas(i,d,c,S,!0,!1),d.setDatas(r,f,a,b,!0,!1),p.setDatas(n,x,_,P,!1,!1),x.setDatas(s,p,o,F,!1,!1),b.setDatas(d),S.setDatas(f),P.setDatas(_,!1),F.setDatas(h,!1),n.set_fromConstraintSegments([T,O]),i.set_fromConstraintSegments([T,D]),s.set_fromConstraintSegments([D,k]),r.set_fromConstraintSegments([k,O]),o.fromConstraintSegments.push(T),a.fromConstraintSegments.push(T),h.fromConstraintSegments.push(D),u.fromConstraintSegments.push(D),_.fromConstraintSegments.push(k),c.fromConstraintSegments.push(k),g.fromConstraintSegments.push(O),l.fromConstraintSegments.push(O),T.get_edges().push(o),D.get_edges().push(h),k.get_edges().push(_),O.get_edges().push(g),T.fromShape=V,D.fromShape=V,k.fromShape=V,O.fromShape=V;for(var N=0,M=[T,D,k,O];N<M.length;){var j=M[N];++N,V.segments.push(j)}for(var R=0,I=[n,i,s,r];R<I.length;){var A=I[R];++R,L._vertices.push(A)}for(var B=0,q=[o,a,h,u,_,c,g,l,f,d,p,x];B<q.length;){var Y=q[B];++B,L._edges.push(Y)}for(var X=0,G=[b,S,P,F];X<G.length;){var W=G[X];++X,L._faces.push(W)}L.get___constraintShapes().push(V);for(var z=[],H=0,U=[0,0,t,0];H<U.length;){var Q=U[H];++H,z.push(Q)}for(var K=0,$=[t,0,t,e];K<$.length;){var J=$[K];++K,z.push(J)}for(var Z=0,tt=[t,e,0,e];Z<tt.length;){var et=tt[Z];++Z,z.push(et)}for(var nt=0,it=[0,e,0,0];nt<it.length;){var st=it[nt];++nt,z.push(st)}return L.set_clipping(!1),L.insertConstraintShape(z),L.set_clipping(!0),L},q.prototype={__class__:q};var Y=t.hxDaedalus.iterators.FromEdgeToRotatedEdges=function(){};Y.__name__=!0,Y.prototype={__class__:Y};var X=t.hxDaedalus.iterators.FromFaceToInnerEdges=function(){};X.__name__=!0,X.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){return null!=this._nextEdge?(this._resultEdge=this._nextEdge,this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()&&(this._nextEdge=null)):this._resultEdge=null,this._resultEdge},__class__:X};var G=t.hxDaedalus.iterators.FromFaceToInnerVertices=function(){};G.__name__=!0,G.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){return null!=this._nextEdge?(this._resultVertex=this._nextEdge.get_originVertex(),this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()&&(this._nextEdge=null)):this._resultVertex=null,this._resultVertex},__class__:G};var W=t.hxDaedalus.iterators.FromFaceToNeighbourFaces=function(){};W.__name__=!0,W.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){if(null!=this._nextEdge)for(;;){if(this._resultFace=this._nextEdge.get_rightFace(),this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()){this._nextEdge=null,this._resultFace.get_isReal()||(this._resultFace=null);break}if(this._resultFace.get_isReal())break}else this._resultFace=null;return this._resultFace},__class__:W};var z=t.hxDaedalus.iterators.FromMeshToFaces=function(){};z.__name__=!0,z.prototype={set_fromMesh:function(t){return this._fromMesh=t,this._currIndex=0,t},next:function(){for(;;){if(!(this._currIndex<this._fromMesh._faces.length)){this._resultFace=null;break}if(this._resultFace=this._fromMesh._faces[this._currIndex],this._currIndex++,this._resultFace.get_isReal())break}return this._resultFace},__class__:z};var H=t.hxDaedalus.iterators.FromMeshToVertices=function(){};H.__name__=!0,H.prototype={set_fromMesh:function(t){return this._fromMesh=t,this._currIndex=0,t},next:function(){for(;;){if(!(this._currIndex<this._fromMesh._vertices.length)){this._resultVertex=null;break}if(this._resultVertex=this._fromMesh._vertices[this._currIndex],this._currIndex++,this._resultVertex.get_isReal())break}return this._resultVertex},__class__:H};var U=t.hxDaedalus.iterators.FromVertexToHoldingFaces=function(){};U.__name__=!0,U.prototype={set_fromVertex:function(t){return this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge(),t},next:function(){if(null!=this._nextEdge)for(;;){if(this._resultFace=this._nextEdge.get_leftFace(),this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null,this._resultFace.get_isReal()||(this._resultFace=null);break}if(this._resultFace.get_isReal())break}else this._resultFace=null;return this._resultFace},__class__:U};var Q=t.hxDaedalus.iterators.FromVertexToIncomingEdges=function(){};Q.__name__=!0,Q.prototype={set_fromVertex:function(t){for(this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge();!this._nextEdge.get_isReal();)this._nextEdge=this._nextEdge.get_rotLeftEdge();return t},next:function(){if(null!=this._nextEdge)for(this._resultEdge=this._nextEdge.get_oppositeEdge();;){if(this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null;break}if(this._nextEdge.get_isReal())break}else this._resultEdge=null;return this._resultEdge},__class__:Q};var K=t.hxDaedalus.iterators.FromVertexToNeighbourVertices=function(){};K.__name__=!0,K.prototype={set_fromVertex:function(t){return this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge(),t},next:function(){if(null!=this._nextEdge){for(this._resultVertex=this._nextEdge.get_oppositeEdge().get_originVertex();this._nextEdge=this._nextEdge.get_rotLeftEdge(),!this._nextEdge.get_isReal(););this._nextEdge==this._fromVertex.get_edge()&&(this._nextEdge=null)}else this._resultVertex=null;return this._resultVertex},__class__:K};var $=t.hxDaedalus.iterators.FromVertexToOutgoingEdges=function(){this.realEdgesOnly=!0};$.__name__=!0,$.prototype={set_fromVertex:function(t){for(this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge();this.realEdgesOnly&&!this._nextEdge.get_isReal();)this._nextEdge=this._nextEdge.get_rotLeftEdge();return t},next:function(){if(null!=this._nextEdge)for(this._resultEdge=this._nextEdge;;){if(this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null;break}if(!this.realEdgesOnly||this._nextEdge.get_isReal())break}else this._resultEdge=null;return this._resultEdge},__class__:$};var J=t.hxDaedalus.view.SimpleView=function(t){this.faceToEdgeIter=new X,this.faceAlpha=.5,this.faceWidth=1,this.faceColor=16711935,this.entitiesAlpha=.75,this.entitiesWidth=1,this.entitiesColor=65280,this.pathsAlpha=.75,this.pathsWidth=1.5,this.pathsColor=16760848,this.verticesAlpha=.25,this.verticesRadius=.5,this.verticesColor=255,this.constraintsAlpha=1,this.constraintsWidth=2,this.constraintsColor=16711680,this.edgesAlpha=.25,this.edgesWidth=1,this.edgesColor=10066329,this.graphics=new gt(t)};J.__name__=!0,J.prototype={drawVertex:function(t){this.graphics.graphics.lineStyle(this.verticesRadius,this.verticesColor,this.verticesAlpha),this.graphics.graphics.beginFill(this.verticesColor,this.verticesAlpha);var e=this.graphics,n=t.get_pos().x,i=t.get_pos().y;e.graphics.drawCircle(n,i,this.verticesRadius),this.graphics.graphics.endFill()},drawFace:function(t){this.faceToEdgeIter.set_fromFace(t),this.graphics.graphics.beginFill(this.faceColor,this.faceAlpha),this.graphics.graphics.lineStyle(this.faceWidth,this.faceColor,this.faceAlpha);for(var e,n=0;null!=(e=this.faceToEdgeIter.next());){if(0==n){var i=this.graphics,s=e.get_originVertex().get_pos().x,r=e.get_originVertex().get_pos().y;i.graphics.moveTo(s,r)}var o=this.graphics,a=e.get_destinationVertex().get_pos().x,h=e.get_destinationVertex().get_pos().y;o.graphics.lineTo(a,h),++n}this.graphics.graphics.endFill()},drawEdge:function(t){if(t.get_isConstrained()){this.graphics.graphics.lineStyle(this.constraintsWidth,this.constraintsColor,this.constraintsAlpha);var e=this.graphics,n=t.get_originVertex().get_pos().x,i=t.get_originVertex().get_pos().y;e.graphics.moveTo(n,i);var s=this.graphics,r=t.get_destinationVertex().get_pos().x,o=t.get_destinationVertex().get_pos().y;s.graphics.lineTo(r,o)}else{this.graphics.graphics.lineStyle(this.edgesWidth,this.edgesColor,this.edgesAlpha);var a=this.graphics,h=t.get_originVertex().get_pos().x,u=t.get_originVertex().get_pos().y;a.graphics.moveTo(h,u);var _=this.graphics,c=t.get_destinationVertex().get_pos().x,g=t.get_destinationVertex().get_pos().y;_.graphics.lineTo(c,g)}},drawMesh:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear();for(var n=t.getVerticesAndEdges(),i=0,s=n.vertices;i<s.length;){var r=s[i];++i,this.drawVertex(r)}for(var o=0,a=n.edges;o<a.length;){var h=a[o];++o,this.drawEdge(h)}},drawEntity:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear(),this.graphics.graphics.lineStyle(this.entitiesWidth,this.entitiesColor,this.entitiesAlpha),this.graphics.graphics.beginFill(this.entitiesColor,this.entitiesAlpha);var n=this.graphics,i=t.x,s=t.y,r=t.get_radius();n.graphics.drawCircle(i,s,r),this.graphics.graphics.endFill()},drawEntities:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear();for(var n=0,i=t.length;n<i;){var s=n++;this.drawEntity(t[s],!1)}},drawPath:function(t,e){if(null==e&&(e=!1),e&&this.graphics.graphics.clear(),0!=t.length){this.graphics.graphics.lineStyle(this.pathsWidth,this.pathsColor,this.pathsAlpha),this.graphics.graphics.moveTo(t[0],t[1]);for(var n=2;n<t.length;)this.graphics.graphics.lineTo(t[n],t[n+1]),this.graphics.graphics.moveTo(t[n],t[n+1]),n+=2}},__class__:J};var Z=t.hxPixels._Pixels.Pixels_Impl_={};Z.__name__=!0,Z._new=function(t,e,n){return null==n&&(n=!0),new tt(t,e,n)},Z.getByte=function(t,e){return t.bytes.b[(-4&e)+t.format.channelMap[3&e]]},Z.getPixel=function(t,e,n){var i=n*t.width+e<<2;return t.bytes.b[i+t.format.ch1]<<16|t.bytes.b[i+t.format.ch2]<<8|t.bytes.b[i+t.format.ch3]},Z.getPixel32=function(t,e,n){var i=n*t.width+e<<2;return t.bytes.b[i+t.format.ch0]<<24|t.bytes.b[i+t.format.ch1]<<16|t.bytes.b[i+t.format.ch2]<<8|t.bytes.b[i+t.format.ch3]},Z.setByte=function(t,e,n){t.bytes.b[(-4&e)+t.format.channelMap[3&e]]=255&n},Z.setPixel=function(t,e,n,i){var s=n*t.width+e<<2,r=i>>16&255,o=i>>8&255,a=255&i;t.bytes.b[s+t.format.ch1]=255&r,t.bytes.b[s+t.format.ch2]=255&o,t.bytes.b[s+t.format.ch3]=255&a},Z.setPixel32=function(t,e,n,i){var s=n*t.width+e<<2,r=i>>24&255,o=i>>16&255,a=i>>8&255,h=255&i;t.bytes.b[s+t.format.ch0]=255&r,t.bytes.b[s+t.format.ch1]=255&o,t.bytes.b[s+t.format.ch2]=255&a,t.bytes.b[s+t.format.ch3]=255&h},Z.fillRect=function(t,e,n,i,s,r){var o=n*t.width+e<<2,a=new tt(i,1,!0);a.format=t.format;for(var h=i<<2,u=0,_=i;u<_;){var c=u++;Z.setPixel32(a,c,0,r)}for(var g=0,l=s;g<l;){g++;t.bytes.blit(o,a.bytes,0,h),o+=t.width<<2}},Z.clone=function(t){var e=new tt(t.width,t.height,!0);return e.bytes.blit(0,t.bytes,0,t.bytes.length),e.format=t.format,e},Z.fromBytes=function(t,e,n,i){var s=new tt(e,n,!1);return null==i&&(i=et.ARGB),s.bytes=t,s},Z.convertTo=function(t,e){return Z.convert(t,e,!0)},Z.convert=function(t,e,n){null==n&&(n=!1);var i=n?t:Z.clone(t);if(e==t.format)return i;var s=0,r=0;if(t.format==et.BGRA&&e==et.RGBA||t.format==et.RGBA&&e==et.BGRA)for(;s<t.count;){var o=r+1,a=t.bytes.b[(-4&o)+t.format.channelMap[3&o]],h=r+3,u=t.bytes.b[(-4&h)+t.format.channelMap[3&h]];i.bytes.b[r+e.ch1]=255&a,i.bytes.b[r+e.ch3]=255&u,++s,r+=4}else for(;s<t.count;){var _=t.bytes.b[(-4&r)+t.format.channelMap[3&r]],c=r+1,g=t.bytes.b[(-4&c)+t.format.channelMap[3&c]],l=r+2,f=t.bytes.b[(-4&l)+t.format.channelMap[3&l]],d=r+3,p=t.bytes.b[(-4&d)+t.format.channelMap[3&d]];i.bytes.b[r+e.ch0]=255&_,i.bytes.b[r+e.ch1]=255&g,i.bytes.b[r+e.ch2]=255&f,i.bytes.b[r+e.ch3]=255&p,++s,r+=4}return i.format=e,i},Z.fromImageData=function(t){var e=new tt(t.width,t.height,!0);e.format=et.ARGB;for(var n=t.data,i=0,s=n.byteLength;i<s;){var r=i++;e.bytes.b[r]=255&n[r]}return e};var tt=function(t,e,n,i){null==n&&(n=!0),this.count=t*e,n&&(this.bytes=new u(new wt(this.count<<2))),this.width=t,this.height=e,this.format=null!=i?i:et.ARGB};tt.__name__=!0,tt.prototype={__class__:tt};var et=t.hxPixels.PixelFormat=function(t,e,n,i,s){null==s&&(s="PixelFormat"),this.channelMap=[t,e,n,i],this.ch0=t,this.ch1=e,this.ch2=n,this.ch3=i,this.name=s};et.__name__=!0,et.prototype={get_A:function(){return this.ch0},get_R:function(){return this.ch1},get_G:function(){return this.ch2},get_B:function(){return this.ch3},toString:function(){return this.name},__class__:et};var nt=t.hxPixels._Pixels.Pixel_Impl_={};nt.__name__=!0,nt.get_A=function(t){return t>>24&255},nt.set_A=function(t,e){return t=16777215&t|(e&=255)<<24,e},nt.get_R=function(t){return t>>16&255},nt.set_R=function(t,e){return t=-16711681&t|(e&=255)<<16,e},nt.get_G=function(t){return t>>8&255},nt.set_G=function(t,e){return t=-65281&t|(e&=255)<<8,e},nt.get_B=function(t){return 255&t},nt.set_B=function(t,e){return t=-256&t|(e&=255),e};var it=function(t){Error.call(this),this.val=t,this.message=String(t),Error.captureStackTrace&&Error.captureStackTrace(this,it)};it.__name__=!0,it.wrap=function(t){return t instanceof Error?t:new it(t)},it.__super__=Error,it.prototype=function(t,e){function n(){}n.prototype=t;var i=new n;for(var s in e)i[s]=e[s];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}(Error.prototype,{__class__:it});var st=function(){};st.__name__=!0,st.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var n=st.__nativeClassName(t);return null!=n?st.__resolveNativeClass(n):null},st.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var n=typeof t;switch("function"==n&&(t.__name__||t.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var i=t[0]+"(";e+="\t";for(var s=2,r=t.length;s<r;){var o=s++;i+=2!=o?","+st.__string_rec(t[o],e):st.__string_rec(t[o],e)}return i+")"}var a="[";e+="\t";for(var h=0,u=t.length;h<u;){var _=h++;a+=(_>0?",":"")+st.__string_rec(t[_],e)}return a+="]"}var c;try{c=t.toString}catch(t){return"???"}if(null!=c&&c!=Object.toString&&"function"==typeof c){var g=t.toString();if("[object Object]"!=g)return g}var l=null,f="{\n";e+="\t";var d=null!=t.hasOwnProperty;for(var l in t)d&&!t.hasOwnProperty(l)||"prototype"!=l&&"__class__"!=l&&"__super__"!=l&&"__interfaces__"!=l&&"__properties__"!=l&&(2!=f.length&&(f+=", \n"),f+=e+l+" : "+st.__string_rec(t[l],e));return f+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},st.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var n=t.__interfaces__;if(null!=n)for(var i=0,s=n.length;i<s;){var r=n[i++];if(r==e||st.__interfLoop(r,e))return!0}return st.__interfLoop(t.__super__,e)},st.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case vt:return"boolean"==typeof t;case pt:return!0;case xt:return"number"==typeof t;case dt:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(st.__interfLoop(st.getClass(t),e))return!0}else if("object"==typeof e&&st.__isNativeObj(e)&&t instanceof e)return!0;return e==mt&&null!=t.__name__||(e==yt&&null!=t.__ename__||t.__enum__==e)}},st.__nativeClassName=function(t){var e=st.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},st.__isNativeObj=function(t){return null!=st.__nativeClassName(t)},st.__resolveNativeClass=function(t){return e[t]};var rt=function(t){if(t instanceof Array&&null==t.__enum__)this.a=t,this.byteLength=t.length;else{var e=t;this.a=[];for(var n=0,i=e;n<i;){var s=n++;this.a[s]=0}this.byteLength=e}};rt.__name__=!0,rt.sliceImpl=function(t,e){var n=new bt(this,t,null==e?null:e-t),i=new wt(n.byteLength);return new bt(i).set(n),i},rt.prototype={slice:function(t,e){return new rt(this.a.slice(t,e))},__class__:rt};var ot=function(){};ot.__name__=!0,ot._new=function(t,e,n){var i;if("number"==typeof t){i=[];for(var r=0,o=t;r<o;){i[r++]=0}i.byteLength=i.length,i.byteOffset=0,i.buffer=new rt(i)}else if(st.__instanceof(t,rt)){var a=t;null==e&&(e=0),null==n&&(n=a.byteLength-e),(i=0==e?a.a:a.a.slice(e,e+n)).byteLength=i.length,i.byteOffset=e,i.buffer=a}else{if(!(t instanceof Array&&null==t.__enum__))throw new it("TODO "+s.string(t));(i=t.slice()).byteLength=i.length,i.byteOffset=0,i.buffer=new rt(i)}return i.subarray=ot._subarray,i.set=ot._set,i},ot._set=function(t,e){if(st.__instanceof(t.buffer,rt)){var n=t;if(t.byteLength+e>this.byteLength)throw new it("set() outside of range");for(var i=0,s=t.byteLength;i<s;){var r=i++;this[r+e]=n[r]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new it("TODO");var o=t;if(o.length+e>this.byteLength)throw new it("set() outside of range");for(var a=0,h=o.length;a<h;){var u=a++;this[u+e]=o[u]}}},ot._subarray=function(t,e){var n=ot._new(this.slice(t,e));return n.byteOffset=t,n};var at=t.wings.core.ISimpleDrawingContext=function(){};at.__name__=!0,at.prototype={__class__:at};var ht=t.wings.jsCanvas.BasicCanvas=function(){this.canvas=window.document.createElement("canvas"),this.dom=this.canvas,this.body=window.document.body,this.surface=this.canvas.getContext("2d",null),this.style=this.dom.style,this.header=new ut,this.canvas.width=this.header.width,this.canvas.height=this.header.height,this.style.paddingLeft="0px",this.style.paddingTop="0px",this.style.left=s.string("0px"),this.style.top=s.string("0px"),this.style.position="absolute",this.style.backgroundColor=this.header.bgColor,this.surface.fillStyle=this.header.bgColor,this.image=this.dom;var t=window.document.createElement("style");t.innerHTML="@keyframes spin { from { transform:rotate( 0deg ); } to { transform:rotate( 360deg ); } }",window.document.getElementsByTagName("head")[0].appendChild(t),t.animation="spin 1s linear infinite",this.loop(this.header.frameRate),window.document.body.appendChild(this.dom)};ht.__name__=!0,ht.prototype={loop:function(t){return window.requestAnimationFrame(ft(this,this.loop)),null!=this.onEnterFrame&&this.onEnterFrame(),!0},clear:function(){this.surface.clearRect(0,0,this.header.width,this.header.height)},drawCircle:function(t,e,n){this.surface.beginPath(),this.surface.arc(t,e,n,0,2*Math.PI,!1),this.surface.stroke(),this.surface.closePath()},drawRect:function(t,e,n,i){this.surface.beginPath(),this.surface.moveTo(t,e),this.surface.lineTo(t+n,e),this.surface.lineTo(t+n,e+i),this.surface.lineTo(t,e+i),this.surface.stroke(),this.surface.closePath()},drawTri:function(t){this.surface.beginPath();for(var e=0;e<t.length;)0==e?this.surface.moveTo(t[e],t[e+1]):this.surface.lineTo(t[e],t[e+1]),e+=2;this.surface.stroke(),this.surface.closePath()},lineStyle:function(t,e,n){if(this.surface.lineWidth=t,null!=n&&1!=n){var i=e>>16&255,s=e>>8&255,o=255&e;this.surface.strokeStyle="rgba("+i+","+s+","+o+","+n+")"}else{var a=r.hex(e,6);this.surface.strokeStyle="#"+a}},moveTo:function(t,e){this.surface.beginPath(),this.surface.moveTo(t,e)},lineTo:function(t,e){this.surface.lineTo(t,e),this.surface.closePath(),this.surface.stroke()},quadTo:function(t,e,n,i){this.surface.quadraticCurveTo(t,e,n,i),this.surface.stroke()},beginFill:function(t,e){if(null!=e&&1!=e){var n=t>>16&255,i=t>>8&255,s=255&t;this.surface.fillStyle="rgba("+n+","+i+","+s+","+e+")"}else{var o=r.hex(t,6);this.surface.fillStyle="#"+o}this.surface.beginPath()},endFill:function(){this.surface.stroke(),this.surface.closePath(),this.surface.fill()},__class__:ht};var ut=function(){var t=null.split(":");this.width=s.parseInt(t[0]),this.height=s.parseInt(t[1]),this.frameRate=s.parseInt(t[2]),this.bgColor="#"+t[3]};ut.__name__=!0,ut.prototype={parseInt:function(t){return s.parseInt(t)},toHashColor:function(t){return"#"+t},__class__:ut};var _t=t.wings.jsCanvas.CanvasPixelMatrix=function(t,e,n){this.data=t,this.width=e,this.height=n,this.lookup=[];for(var i=0,s=0,r=this.height;s<r;){var o=s++;this.lookup[o]=[];for(var a=0,h=this.width;a<h;){var u=a++;this.lookup[o][u]=4*i|0,++i}}};_t.__name__=!0,_t.createCanvasPixelMatrixFromContext=function(t,e,n){var i=t.getImageData(0,0,e,n).data;return new _t(i,e,n)},_t.prototype={getPixel32:function(t,e){var n=this.lookup[e][t];return this.data[n+3]<<24|this.data[n]<<16|this.data[n+1]<<8|this.data[n+2]},setPixel32:function(t,e,n){var i=this.lookup[e][t];this.data[i+3]=n>>24&255,this.data[i]=n>>16&255,this.data[i+1]=n>>8&255,this.data[i+2]=255&n},setPixel:function(t,e,n){var i=this.lookup[e][t];this.data[i]=n>>16&255,this.data[i+1]=n>>8&255,this.data[i+2]=255&n},getPixel:function(t,e){var n=this.lookup[e][t];return this.data[n]<<16|this.data[n+1]<<8|this.data[n+2]},__class__:_t};var ct=t.wings.jsCanvas.ImageLoader=function(t,e){this.images=new h,this.loaded=e,this.count=t.length;for(var n=0;n<t.length;){var i=t[n];++n,this.load(i)}};ct.__name__=!0,ct.prototype={load:function(t){var e=window.document.createElement("img"),n=e.style;n.left="0px",n.top="0px",n.paddingLeft="0px",n.paddingTop="0px";var i=ft(this,this.store),s=e,r=t.split("/").pop();e.onload=function(t){i(s,r,t)},n.position="absolute",e.src=t},store:function(t,e,n){this.count--;var i=this.images;null!=Et[e]?i.setReserved(e,t):i.h[e]=t,0==this.count&&this.loaded()},__class__:ct};var gt=t.wings.jsCanvas.SimpleDrawingContext=function(t){this.graphics=t};gt.__name__=!0,gt.__interfaces__=[at],gt.prototype={clear:function(){this.graphics.clear()},lineStyle:function(t,e,n){null==n&&(n=1),this.graphics.lineStyle(t,e,n)},beginFill:function(t,e){null==e&&(e=1),this.graphics.beginFill(t,e)},endFill:function(){this.graphics.endFill()},moveTo:function(t,e){this.graphics.moveTo(t,e)},lineTo:function(t,e){this.graphics.lineTo(t,e)},quadTo:function(t,e,n,i){this.graphics.quadTo(t,e,n,i)},drawCircle:function(t,e,n){this.graphics.drawCircle(t,e,n)},drawRect:function(t,e,n,i){this.graphics.drawRect(t,e,n,i)},drawEquilaterialTri:function(t,e,n,i){for(var s,r,o=2*Math.PI/3,a=[],h=0;h<3;){var u=h++;s=t+n*Math.cos(i+u*o),r=e+n*Math.sin(i+u*o),a.push(s),a.push(r)}this.graphics.drawTri(a)},drawTri:function(t){this.graphics.drawTri(t)},__class__:gt};var lt=0;function ft(t,e){return null==e?null:(null==e.__id__&&(e.__id__=lt++),null==t.hx__closures__?t.hx__closures__={}:n=t.hx__closures__[e.__id__],null==n&&((n=function(){return n.method.apply(n.scope,arguments)}).scope=t,n.method=e,t.hx__closures__[e.__id__]=n),n);var n}String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var dt={__name__:["Int"]},pt={__name__:["Dynamic"]},xt=Number;xt.__name__=["Float"];var vt=Boolean;vt.__ename__=["Bool"];var mt={__name__:["Class"]},yt={},Et={};et.ARGB=new et(0,1,2,3,"ARGB"),et.RGBA=new et(3,0,1,2,"RGBA"),et.BGRA=new et(3,2,1,0,"BGRA");var wt=e.ArrayBuffer||rt;null==wt.prototype.slice&&(wt.prototype.slice=rt.sliceImpl);var bt=e.Uint8Array||ot._new;a.count=0,g.NUM_SEGMENTS=6,x.EPSILON=.01,x.EPSILON_SQUARED=1e-4,v.INC=0,m.INC=0,y.INC=0,E.INC=0,w.INC=0,b.INC=0,C.INC=0,S.INC=0,P.INC=0,F.INC=0,k.__samples=[],k.__circumcenter=new D,N.MAX_INT=2147483647,N.maxDistance=1,Z.CHANNEL_MASK=3,tt.BYTES_PER_PIXEL=4,st.__toStr={}.toString,ot.BYTES_PER_ELEMENT=1,ut.__meta__={fields:{parseInt:{static:null},toHashColor:{static:null}}}}(e,"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this)}).call(this,n(37))},function(t,e,n){var i=n(38),s=n(17);t.exports=function(t){return i(s(t))}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var i,s,r,o=n(72),a=n(0),h=n(7),u=n(9),_=n(4),c=n(25),g=n(26),l=a.WeakMap;if(o){var f=new l,d=f.get,p=f.has,x=f.set;i=function(t,e){return x.call(f,t,e),e},s=function(t){return d.call(f,t)||{}},r=function(t){return p.call(f,t)}}else{var v=c("state");g[v]=!0,i=function(t,e){return u(t,v,e),e},s=function(t){return _(t,v)?t[v]:{}},r=function(t){return _(t,v)}}t.exports={set:i,get:s,has:r,enforce:function(t){return r(t)?s(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!h(e)||(n=s(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){var i=n(3),s=n(71),r=n(21),o=n(16),a=n(39),h=n(4),u=n(40),_=Object.getOwnPropertyDescriptor;e.f=i?_:function(t,e){if(t=o(t),e=a(e,!0),u)try{return _(t,e)}catch(t){}if(h(t,e))return r(!s.f.call(t,e),t[e])}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(0),s=n(7),r=i.document,o=s(r)&&s(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){var i=n(0),s=n(9);t.exports=function(t,e){try{s(i,t,e)}catch(n){i[t]=e}return e}},function(t,e,n){var i=n(41),s=Function.toString;"function"!=typeof i.inspectSource&&(i.inspectSource=function(t){return s.call(t)}),t.exports=i.inspectSource},function(t,e,n){var i=n(42),s=n(43),r=i("keys");t.exports=function(t){return r[t]||(r[t]=s(t))}},function(t,e){t.exports={}},function(t,e,n){var i=n(28),s=Math.min;t.exports=function(t){return t>0?s(i(t),9007199254740991):0}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){var i=n(19);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,s){return t.call(e,n,i,s)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i=n(1),s=n(50),r=n(8),o=i("unscopables"),a=Array.prototype;null==a[o]&&r.f(a,o,{configurable:!0,value:s(null)}),t.exports=function(t){a[o][t]=!0}},function(t,e,n){var i=n(3),s=n(2),r=n(4),o=Object.defineProperty,a={},h=function(t){throw t};t.exports=function(t,e){if(r(a,t))return a[t];e||(e={});var n=[][t],u=!!r(e,"ACCESSORS")&&e.ACCESSORS,_=r(e,0)?e[0]:h,c=r(e,1)?e[1]:void 0;return a[t]=!!n&&!s((function(){if(u&&!i)return!0;var t={length:-1};u?o(t,1,{enumerable:!0,get:h}):t[1]=1,n.call(t,_,c)}))}},function(t,e,n){var i=n(8).f,s=n(4),r=n(1)("toStringTag");t.exports=function(t,e,n){t&&!s(t=n?t:t.prototype,r)&&i(t,r,{configurable:!0,value:e})}},function(t,e,n){var i={};i[n(1)("toStringTag")]="z",t.exports="[object z]"===String(i)},function(t,e,n){var i=n(12);t.exports=i("navigator","userAgent")||""},function(t,e,n){(function(e){t.exports=e.env.PROMISE_QUEUE_COVERAGE?n(117):n(118)}).call(this,n(116))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(2),s=n(10),r="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?r.call(t,""):Object(t)}:Object},function(t,e,n){var i=n(7);t.exports=function(t,e){if(!i(t))return t;var n,s;if(e&&"function"==typeof(n=t.toString)&&!i(s=n.call(t)))return s;if("function"==typeof(n=t.valueOf)&&!i(s=n.call(t)))return s;if(!e&&"function"==typeof(n=t.toString)&&!i(s=n.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(3),s=n(2),r=n(22);t.exports=!i&&!s((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(0),s=n(23),r=i["__core-js_shared__"]||s("__core-js_shared__",{});t.exports=r},function(t,e,n){var i=n(13),s=n(41);(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:i?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+i).toString(36)}},function(t,e,n){var i=n(4),s=n(16),r=n(45).indexOf,o=n(26);t.exports=function(t,e){var n,a=s(t),h=0,u=[];for(n in a)!i(o,n)&&i(a,n)&&u.push(n);for(;e.length>h;)i(a,n=e[h++])&&(~r(u,n)||u.push(n));return u}},function(t,e,n){var i=n(16),s=n(27),r=n(77),o=function(t){return function(e,n,o){var a,h=i(e),u=s(h.length),_=r(o,u);if(t&&n!=n){for(;u>_;)if((a=h[_++])!=a)return!0}else for(;u>_;_++)if((t||_ in h)&&h[_]===n)return t||_||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},function(t,e,n){var i=n(2),s=/#|\.prototype\./,r=function(t,e){var n=a[o(t)];return n==u||n!=h&&("function"==typeof e?i(e):!!e)},o=r.normalize=function(t){return String(t).replace(s,".").toLowerCase()},a=r.data={},h=r.NATIVE="N",u=r.POLYFILL="P";t.exports=r},function(t,e,n){var i=n(30),s=n(38),r=n(48),o=n(27),a=n(79),h=[].push,u=function(t){var e=1==t,n=2==t,u=3==t,_=4==t,c=6==t,g=5==t||c;return function(l,f,d,p){for(var x,v,m=r(l),y=s(m),E=i(f,d,3),w=o(y.length),b=0,C=p||a,S=e?C(l,w):n?C(l,0):void 0;w>b;b++)if((g||b in y)&&(v=E(x=y[b],b,m),t))if(e)S[b]=v;else if(v)switch(t){case 3:return!0;case 5:return x;case 6:return b;case 2:h.call(S,x)}else if(_)return!1;return c?-1:u||_?_:S}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(t,e,n){var i=n(17);t.exports=function(t){return Object(i(t))}},function(t,e,n){var i=n(2);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},function(t,e,n){var i,s=n(5),r=n(82),o=n(29),a=n(26),h=n(51),u=n(22),_=n(25),c=_("IE_PROTO"),g=function(){},l=function(t){return"<script>"+t+"<\/script>"},f=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;f=i?function(t){t.write(l("")),t.close();var e=t.parentWindow.Object;return t=null,e}(i):((e=u("iframe")).style.display="none",h.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(l("document.F=Object")),t.close(),t.F);for(var n=o.length;n--;)delete f.prototype[o[n]];return f()};a[c]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(g.prototype=s(t),n=new g,g.prototype=null,n[c]=t):n=f(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(12);t.exports=i("document","documentElement")},function(t,e,n){"use strict";var i=n(6),s=n(53);i({target:"Array",proto:!0,forced:[].forEach!=s},{forEach:s})},function(t,e,n){"use strict";var i=n(47).forEach,s=n(84),r=n(32),o=s("forEach"),a=r("forEach");t.exports=o&&a?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,e,n){"use strict";var i=n(16),s=n(31),r=n(14),o=n(18),a=n(55),h=o.set,u=o.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,e){h(this,{type:"Array Iterator",target:i(t),index:0,kind:e})}),(function(){var t=u(this),e=t.target,n=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values"),r.Arguments=r.Array,s("keys"),s("values"),s("entries")},function(t,e,n){"use strict";var i=n(6),s=n(86),r=n(57),o=n(88),a=n(33),h=n(9),u=n(11),_=n(1),c=n(13),g=n(14),l=n(56),f=l.IteratorPrototype,d=l.BUGGY_SAFARI_ITERATORS,p=_("iterator"),x=function(){return this};t.exports=function(t,e,n,_,l,v,m){s(n,e,_);var y,E,w,b=function(t){if(t===l&&V)return V;if(!d&&t in P)return P[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},C=e+" Iterator",S=!1,P=t.prototype,F=P[p]||P["@@iterator"]||l&&P[l],V=!d&&F||b(l),T="Array"==e&&P.entries||F;if(T&&(y=r(T.call(new t)),f!==Object.prototype&&y.next&&(c||r(y)===f||(o?o(y,f):"function"!=typeof y[p]&&h(y,p,x)),a(y,C,!0,!0),c&&(g[C]=x))),"values"==l&&F&&"values"!==F.name&&(S=!0,V=function(){return F.call(this)}),c&&!m||P[p]===V||h(P,p,V),g[e]=V,l)if(E={values:b("values"),keys:v?V:b("keys"),entries:b("entries")},m)for(w in E)(d||S||!(w in P))&&u(P,w,E[w]);else i({target:e,proto:!0,forced:d||S},E);return E}},function(t,e,n){"use strict";var i,s,r,o=n(57),a=n(9),h=n(4),u=n(1),_=n(13),c=u("iterator"),g=!1;[].keys&&("next"in(r=[].keys())?(s=o(o(r)))!==Object.prototype&&(i=s):g=!0),null==i&&(i={}),_||h(i,c)||a(i,c,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:g}},function(t,e,n){var i=n(4),s=n(48),r=n(25),o=n(87),a=r("IE_PROTO"),h=Object.prototype;t.exports=o?Object.getPrototypeOf:function(t){return t=s(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?h:null}},function(t,e,n){var i=n(6),s=n(3);i({target:"Object",stat:!0,forced:!s,sham:!s},{defineProperty:n(8).f})},function(t,e,n){var i=n(34),s=n(11),r=n(91);i||s(Object.prototype,"toString",r,{unsafe:!0})},function(t,e,n){var i=n(34),s=n(10),r=n(1)("toStringTag"),o="Arguments"==s(function(){return arguments}());t.exports=i?s:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:o?s(e):"Object"==(i=s(e))&&"function"==typeof e.callee?"Arguments":i}},function(t,e,n){"use strict";var i,s,r,o,a=n(6),h=n(13),u=n(0),_=n(12),c=n(62),g=n(11),l=n(92),f=n(33),d=n(93),p=n(7),x=n(19),v=n(94),m=n(10),y=n(24),E=n(95),w=n(99),b=n(63),C=n(64).set,S=n(100),P=n(66),F=n(101),V=n(67),T=n(102),D=n(18),k=n(46),O=n(1),L=n(103),N=O("species"),M="Promise",j=D.get,R=D.set,I=D.getterFor(M),A=c,B=u.TypeError,q=u.document,Y=u.process,X=_("fetch"),G=V.f,W=G,z="process"==m(Y),H=!!(q&&q.createEvent&&u.dispatchEvent),U=k(M,(function(){if(!(y(A)!==String(A))){if(66===L)return!0;if(!z&&"function"!=typeof PromiseRejectionEvent)return!0}if(h&&!A.prototype.finally)return!0;if(L>=51&&/native code/.test(A))return!1;var t=A.resolve(1),e=function(t){t((function(){}),(function(){}))};return(t.constructor={})[N]=e,!(t.then((function(){}))instanceof e)})),Q=U||!w((function(t){A.all(t).catch((function(){}))})),K=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},$=function(t,e,n){if(!e.notified){e.notified=!0;var i=e.reactions;S((function(){for(var s=e.value,r=1==e.state,o=0;i.length>o;){var a,h,u,_=i[o++],c=r?_.ok:_.fail,g=_.resolve,l=_.reject,f=_.domain;try{c?(r||(2===e.rejection&&et(t,e),e.rejection=1),!0===c?a=s:(f&&f.enter(),a=c(s),f&&(f.exit(),u=!0)),a===_.promise?l(B("Promise-chain cycle")):(h=K(a))?h.call(a,g,l):g(a)):l(s)}catch(t){f&&!u&&f.exit(),l(t)}}e.reactions=[],e.notified=!1,n&&!e.rejection&&Z(t,e)}))}},J=function(t,e,n){var i,s;H?((i=q.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),u.dispatchEvent(i)):i={promise:e,reason:n},(s=u["on"+t])?s(i):"unhandledrejection"===t&&F("Unhandled promise rejection",n)},Z=function(t,e){C.call(u,(function(){var n,i=e.value;if(tt(e)&&(n=T((function(){z?Y.emit("unhandledRejection",i,t):J("unhandledrejection",t,i)})),e.rejection=z||tt(e)?2:1,n.error))throw n.value}))},tt=function(t){return 1!==t.rejection&&!t.parent},et=function(t,e){C.call(u,(function(){z?Y.emit("rejectionHandled",t):J("rejectionhandled",t,e.value)}))},nt=function(t,e,n,i){return function(s){t(e,n,s,i)}},it=function(t,e,n,i){e.done||(e.done=!0,i&&(e=i),e.value=n,e.state=2,$(t,e,!0))},st=function(t,e,n,i){if(!e.done){e.done=!0,i&&(e=i);try{if(t===n)throw B("Promise can't be resolved itself");var s=K(n);s?S((function(){var i={done:!1};try{s.call(n,nt(st,t,i,e),nt(it,t,i,e))}catch(n){it(t,i,n,e)}})):(e.value=n,e.state=1,$(t,e,!1))}catch(n){it(t,{done:!1},n,e)}}};U&&(A=function(t){v(this,A,M),x(t),i.call(this);var e=j(this);try{t(nt(st,this,e),nt(it,this,e))}catch(t){it(this,e,t)}},(i=function(t){R(this,{type:M,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=l(A.prototype,{then:function(t,e){var n=I(this),i=G(b(this,A));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=z?Y.domain:void 0,n.parent=!0,n.reactions.push(i),0!=n.state&&$(this,n,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),s=function(){var t=new i,e=j(t);this.promise=t,this.resolve=nt(st,t,e),this.reject=nt(it,t,e)},V.f=G=function(t){return t===A||t===r?new s(t):W(t)},h||"function"!=typeof c||(o=c.prototype.then,g(c.prototype,"then",(function(t,e){var n=this;return new A((function(t,e){o.call(n,t,e)})).then(t,e)}),{unsafe:!0}),"function"==typeof X&&a({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return P(A,X.apply(u,arguments))}}))),a({global:!0,wrap:!0,forced:U},{Promise:A}),f(A,M,!1,!0),d(M),r=_(M),a({target:M,stat:!0,forced:U},{reject:function(t){var e=G(this);return e.reject.call(void 0,t),e.promise}}),a({target:M,stat:!0,forced:h||U},{resolve:function(t){return P(h&&this===r?A:this,t)}}),a({target:M,stat:!0,forced:Q},{all:function(t){var e=this,n=G(e),i=n.resolve,s=n.reject,r=T((function(){var n=x(e.resolve),r=[],o=0,a=1;E(t,(function(t){var h=o++,u=!1;r.push(void 0),a++,n.call(e,t).then((function(t){u||(u=!0,r[h]=t,--a||i(r))}),s)})),--a||i(r)}));return r.error&&s(r.value),n.promise},race:function(t){var e=this,n=G(e),i=n.reject,s=T((function(){var s=x(e.resolve);E(t,(function(t){s.call(e,t).then(n.resolve,i)}))}));return s.error&&i(s.value),n.promise}})},function(t,e,n){var i=n(0);t.exports=i.Promise},function(t,e,n){var i=n(5),s=n(19),r=n(1)("species");t.exports=function(t,e){var n,o=i(t).constructor;return void 0===o||null==(n=i(o)[r])?e:s(n)}},function(t,e,n){var i,s,r,o=n(0),a=n(2),h=n(10),u=n(30),_=n(51),c=n(22),g=n(65),l=o.location,f=o.setImmediate,d=o.clearImmediate,p=o.process,x=o.MessageChannel,v=o.Dispatch,m=0,y={},E=function(t){if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},w=function(t){return function(){E(t)}},b=function(t){E(t.data)},C=function(t){o.postMessage(t+"",l.protocol+"//"+l.host)};f&&d||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++m]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},i(m),m},d=function(t){delete y[t]},"process"==h(p)?i=function(t){p.nextTick(w(t))}:v&&v.now?i=function(t){v.now(w(t))}:x&&!g?(r=(s=new x).port2,s.port1.onmessage=b,i=u(r.postMessage,r,1)):!o.addEventListener||"function"!=typeof postMessage||o.importScripts||a(C)||"file:"===l.protocol?i="onreadystatechange"in c("script")?function(t){_.appendChild(c("script")).onreadystatechange=function(){_.removeChild(this),E(t)}}:function(t){setTimeout(w(t),0)}:(i=C,o.addEventListener("message",b,!1))),t.exports={set:f,clear:d}},function(t,e,n){var i=n(35);t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(i)},function(t,e,n){var i=n(5),s=n(7),r=n(67);t.exports=function(t,e){if(i(t),s(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var i=n(19),s=function(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new s(t)}},function(t,e,n){var i=n(0),s=n(69),r=n(53),o=n(9);for(var a in s){var h=i[a],u=h&&h.prototype;if(u&&u.forEach!==r)try{o(u,"forEach",r)}catch(t){u.forEach=r}}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,n){"use strict";var i=n(6),s=n(47).find,r=n(31),o=n(32),a=!0,h=o("find");"find"in[]&&Array(1).find((function(){a=!1})),i({target:"Array",proto:!0,forced:a||!h},{find:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),r("find")},function(t,e,n){"use strict";var i={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,r=s&&!i.call({1:2},1);e.f=r?function(t){var e=s(this,t);return!!e&&e.enumerable}:i},function(t,e,n){var i=n(0),s=n(24),r=i.WeakMap;t.exports="function"==typeof r&&/native code/.test(s(r))},function(t,e,n){var i=n(4),s=n(74),r=n(20),o=n(8);t.exports=function(t,e){for(var n=s(e),a=o.f,h=r.f,u=0;u<n.length;u++){var _=n[u];i(t,_)||a(t,_,h(e,_))}}},function(t,e,n){var i=n(12),s=n(76),r=n(78),o=n(5);t.exports=i("Reflect","ownKeys")||function(t){var e=s.f(o(t)),n=r.f;return n?e.concat(n(t)):e}},function(t,e,n){var i=n(0);t.exports=i},function(t,e,n){var i=n(44),s=n(29).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,s)}},function(t,e,n){var i=n(28),s=Math.max,r=Math.min;t.exports=function(t,e){var n=i(t);return n<0?s(n+e,0):r(n,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(7),s=n(80),r=n(1)("species");t.exports=function(t,e){var n;return s(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!s(n.prototype)?i(n)&&null===(n=n[r])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){var i=n(10);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(49);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var i=n(3),s=n(8),r=n(5),o=n(83);t.exports=i?Object.defineProperties:function(t,e){r(t);for(var n,i=o(e),a=i.length,h=0;a>h;)s.f(t,n=i[h++],e[n]);return t}},function(t,e,n){var i=n(44),s=n(29);t.exports=Object.keys||function(t){return i(t,s)}},function(t,e,n){"use strict";var i=n(2);t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){"use strict";var i=n(6),s=n(45).includes,r=n(31);i({target:"Array",proto:!0,forced:!n(32)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},function(t,e,n){"use strict";var i=n(56).IteratorPrototype,s=n(50),r=n(21),o=n(33),a=n(14),h=function(){return this};t.exports=function(t,e,n){var u=e+" Iterator";return t.prototype=s(i,{next:r(1,n)}),o(t,u,!1,!0),a[u]=h,t}},function(t,e,n){var i=n(2);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var i=n(5),s=n(89);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return i(n),s(r),e?t.call(n,r):n.__proto__=r,n}}():void 0)},function(t,e,n){var i=n(7);t.exports=function(t){if(!i(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){var i=n(3),s=n(8).f,r=Function.prototype,o=r.toString,a=/^\s*function ([^ (]*)/;i&&!("name"in r)&&s(r,"name",{configurable:!0,get:function(){try{return o.call(this).match(a)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var i=n(34),s=n(60);t.exports=i?{}.toString:function(){return"[object "+s(this)+"]"}},function(t,e,n){var i=n(11);t.exports=function(t,e,n){for(var s in e)i(t,s,e[s],n);return t}},function(t,e,n){"use strict";var i=n(12),s=n(8),r=n(1),o=n(3),a=r("species");t.exports=function(t){var e=i(t),n=s.f;o&&e&&!e[a]&&n(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var i=n(5),s=n(96),r=n(27),o=n(30),a=n(97),h=n(98),u=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,e,n,_,c){var g,l,f,d,p,x,v,m=o(e,n,_?2:1);if(c)g=t;else{if("function"!=typeof(l=a(t)))throw TypeError("Target is not iterable");if(s(l)){for(f=0,d=r(t.length);d>f;f++)if((p=_?m(i(v=t[f])[0],v[1]):m(t[f]))&&p instanceof u)return p;return new u(!1)}g=l.call(t)}for(x=g.next;!(v=x.call(g)).done;)if("object"==typeof(p=h(g,m,v.value,_))&&p&&p instanceof u)return p;return new u(!1)}).stop=function(t){return new u(!0,t)}},function(t,e,n){var i=n(1),s=n(14),r=i("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(s.Array===t||o[r]===t)}},function(t,e,n){var i=n(60),s=n(14),r=n(1)("iterator");t.exports=function(t){if(null!=t)return t[r]||t["@@iterator"]||s[i(t)]}},function(t,e,n){var i=n(5);t.exports=function(t,e,n,s){try{return s?e(i(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&i(r.call(t)),e}}},function(t,e,n){var i=n(1)("iterator"),s=!1;try{var r=0,o={next:function(){return{done:!!r++}},return:function(){s=!0}};o[i]=function(){return this},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n}},function(t,e,n){var i,s,r,o,a,h,u,_,c=n(0),g=n(20).f,l=n(10),f=n(64).set,d=n(65),p=c.MutationObserver||c.WebKitMutationObserver,x=c.process,v=c.Promise,m="process"==l(x),y=g(c,"queueMicrotask"),E=y&&y.value;E||(i=function(){var t,e;for(m&&(t=x.domain)&&t.exit();s;){e=s.fn,s=s.next;try{e()}catch(t){throw s?o():r=void 0,t}}r=void 0,t&&t.enter()},m?o=function(){x.nextTick(i)}:p&&!d?(a=!0,h=document.createTextNode(""),new p(i).observe(h,{characterData:!0}),o=function(){h.data=a=!a}):v&&v.resolve?(u=v.resolve(void 0),_=u.then,o=function(){_.call(u,i)}):o=function(){f.call(c,i)}),t.exports=E||function(t){var e={fn:t,next:void 0};r&&(r.next=e),s||(s=e,o()),r=e}},function(t,e,n){var i=n(0);t.exports=function(t,e){var n=i.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,e,n){var i,s,r=n(0),o=n(35),a=r.process,h=a&&a.versions,u=h&&h.v8;u?s=(i=u.split("."))[0]+i[1]:o&&(!(i=o.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=o.match(/Chrome\/(\d+)/))&&(s=i[1]),t.exports=s&&+s},function(t,e,n){"use strict";var i=n(6),s=n(13),r=n(62),o=n(2),a=n(12),h=n(63),u=n(66),_=n(11);i({target:"Promise",proto:!0,real:!0,forced:!!r&&o((function(){r.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=h(this,a("Promise")),n="function"==typeof t;return this.then(n?function(n){return u(e,t()).then((function(){return n}))}:t,n?function(n){return u(e,t()).then((function(){throw n}))}:t)}}),s||"function"!=typeof r||r.prototype.finally||_(r.prototype,"finally",a("Promise").prototype.finally)},function(t,e,n){var i=n(3),s=n(8),r=n(106),o=n(107).UNSUPPORTED_Y;i&&("g"!=/./g.flags||o)&&s.f(RegExp.prototype,"flags",{configurable:!0,get:r})},function(t,e,n){"use strict";var i=n(5);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var i=n(2);function s(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=i((function(){var t=s("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=i((function(){var t=s("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e,n){"use strict";var i=n(6),s=n(109),r=n(17);i({target:"String",proto:!0,forced:!n(111)("includes")},{includes:function(t){return!!~String(r(this)).indexOf(s(t),arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(110);t.exports=function(t){if(i(t))throw TypeError("The method doesn't accept regular expressions");return t}},function(t,e,n){var i=n(7),s=n(10),r=n(1)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==s(t))}},function(t,e,n){var i=n(1)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(t){}}return!1}},function(t,e,n){"use strict";var i=n(113).charAt,s=n(18),r=n(55),o=s.set,a=s.getterFor("String Iterator");r(String,"String",(function(t){o(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=a(this),n=e.string,s=e.index;return s>=n.length?{value:void 0,done:!0}:(t=i(n,s),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){var i=n(28),s=n(17),r=function(t){return function(e,n){var r,o,a=String(s(e)),h=i(n),u=a.length;return h<0||h>=u?t?"":void 0:(r=a.charCodeAt(h))<55296||r>56319||h+1===u||(o=a.charCodeAt(h+1))<56320||o>57343?t?a.charAt(h):r:t?a.slice(h,h+2):o-56320+(r-55296<<10)+65536}};t.exports={codeAt:r(!1),charAt:r(!0)}},function(t,e,n){var i=n(0),s=n(69),r=n(54),o=n(9),a=n(1),h=a("iterator"),u=a("toStringTag"),_=r.values;for(var c in s){var g=i[c],l=g&&g.prototype;if(l){if(l[h]!==_)try{o(l,h,_)}catch(t){l[h]=_}if(l[u]||o(l,u,c),s[c])for(var f in r)if(l[f]!==r[f])try{o(l,f,r[f])}catch(t){l[f]=r[f]}}}},function(t,e,n){var i=n(6),s=n(0),r=n(35),o=[].slice,a=function(t){return function(e,n){var i=arguments.length>2,s=i?o.call(arguments,2):void 0;return t(i?function(){("function"==typeof e?e:Function(e)).apply(this,s)}:e,n)}};i({global:!0,bind:!0,forced:/MSIE .\./.test(r)},{setTimeout:a(s.setTimeout),setInterval:a(s.setInterval)})},function(t,e){var n,i,s=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var h,u=[],_=!1,c=-1;function g(){_&&h&&(_=!1,h.length?u=h.concat(u):c=-1,u.length&&l())}function l(){if(!_){var t=a(g);_=!0;for(var e=u.length;e;){for(h=u,u=[];++c<e;)h&&h[c].run();c=-1,e=u.length}h=null,_=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function d(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||_||a(l)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=d,s.addListener=d,s.once=d,s.off=d,s.removeListener=d,s.removeAllListeners=d,s.emit=d,s.prependListener=d,s.prependOnceListener=d,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e){},function(t,e,n){var i,s;!function(r,o){"use strict";t.exports?t.exports=o():void 0===(s="function"==typeof(i=o)?i.call(e,n,e,t):i)||(t.exports=s)}(0,(function(){"use strict";var t="undefined"!=typeof Promise?Promise:function(){return{then:function(){throw new Error("Queue.configure() before use Queue")}}},e=function(){};function n(t,e,n){this.options=n=n||{},this.pendingPromises=0,this.maxPendingPromises=void 0!==t?t:1/0,this.maxQueuedPromises=void 0!==e?e:1/0,this.queue=[]}return n.configure=function(e){t=e},n.prototype.add=function(n){var i=this;return new t((function(t,s,r){i.queue.length>=i.maxQueuedPromises?s(new Error("Queue limit reached")):(i.queue.push({promiseGenerator:n,resolve:t,reject:s,notify:r||e}),i._dequeue())}))},n.prototype.getPendingLength=function(){return this.pendingPromises},n.prototype.getQueueLength=function(){return this.queue.length},n.prototype._dequeue=function(){var e=this;if(this.pendingPromises>=this.maxPendingPromises)return!1;var n,i=this.queue.shift();if(!i)return this.options.onEmpty&&this.options.onEmpty(),!1;try{this.pendingPromises++,(n=i.promiseGenerator(),n&&"function"==typeof n.then?n:new t((function(t){t(n)}))).then((function(t){e.pendingPromises--,i.resolve(t),e._dequeue()}),(function(t){e.pendingPromises--,i.reject(t),e._dequeue()}),(function(t){i.notify(t)}))}catch(t){e.pendingPromises--,i.reject(t),e._dequeue()}return!0},n}))},function(t,e,n){"use strict";n.r(e);n(70),n(52),n(85),n(54),n(90),n(58),n(59),n(61),n(104),n(105),n(108),n(112),n(68),n(114),n(115);var i=n(36),s=n.n(i),r=n(15);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=r.hxDaedalus.factories.RectMesh,h=r.hxDaedalus.ai.EntityAI,u=r.hxDaedalus.ai.PathFinder,_=r.hxDaedalus.data.Object,c=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mesh=a.buildRectangle(canvas.dimensions.width,canvas.dimensions.height),this.entity=new h,this.pathFinder=new u,this.pathFinder.entity=this.entity,this.pathFinder.set_mesh(this.mesh),this.path=[],this.walls={},this.blockingTokens=[],canvas.scene.data.walls.forEach((function(t){e.addWall(t)}))}var e,n,i;return e=t,(n=[{key:"addWall",value:function(t){1===t.move&&(0===t.door||1===t.door&&0===t.ds)&&(this.walls[t._id]=this.addLine(t.c[0],t.c[1],t.c[2],t.c[3]))}},{key:"updateBlockingTokens",value:function(t,e){var n=this;this.blockingTokens.forEach((function(t){console.log("removing blocking"),n.deleteObstacle(t)})),canvas.tokens.placeables.forEach((function(i){i.data._id!==t.data._id&&e[i.data.disposition][t.data.disposition]&&n.blockingTokens.push(n.addRectangle(i.x,i.y,i.w,i.h))}))}},{key:"addRectangle",value:function(t,e,n,i){var s=new _;return s.set_coordinates([0,0,0,i,0,i,n,i,n,i,n,0,n,0,0,0]),s.set_x(t),s.set_y(e),this.mesh.insertObject(s),s}},{key:"addLine",value:function(t,e,n,i){var s=new _;return s.set_coordinates([0,0,n-t,i-e]),s.set_x(t),s.set_y(e),this.mesh.insertObject(s),s}},{key:"deleteWallById",value:function(t){this.walls[t]&&this.mesh.deleteObject(this.walls[t])}},{key:"deleteObstacle",value:function(t){this.mesh.deleteObject(t)}},{key:"findPath",value:function(t,e,n,i,s,r){if(this.entity.set_radius(s),this.entity.x=t,this.entity.y=e,r){var o=canvas.grid.getCenter(n,i);this.pathFinder.findPath(o[0],o[1],this.path)}else this.pathFinder.findPath(n,i,this.path);return this.path}},{key:"convertToWaypoints",value:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}},{key:"calculateDistance",value:function(t){for(var e=this.convertToWaypoints(t),n=0,i=e[0],s=1;s<e.length;s++){var r=e[s][0]-i[0],o=e[s][1]-i[1];n+=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),i=e[s]}return Math.round(n/canvas.dimensions.size*canvas.dimensions.distance)}},{key:"drawPath",value:function(t,e){var n=this;return new Promise((function(e){var i={type:CONST.DRAWING_TYPES.POLYGON,author:game.user._id,x:0,y:0,points:n.convertToWaypoints(t),strokeWidth:15,strokeColor:game.user.color,strokeAlpha:.7,text:n.calculateDistance(t)+game.scenes.viewed.data.gridUnits,fontSize:48,flags:["routeFinderPath"],textColor:game.user.color};Drawing.create(i).then((function(t){e(t)}))}))}}])&&o(e.prototype,n),i&&o(e,i),t}();var g=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),game.settings.register("route-finder","snapToGrid",{name:game.i18n.localize("route-finder.snapToGrid.name"),hint:game.i18n.localize("route-finder.snapToGrid.hint"),scope:"world",config:!0,default:!0,type:Boolean}),game.settings.register("route-finder","reportMoveToChat",{name:game.i18n.localize("route-finder.reportMoveToChat.name"),hint:game.i18n.localize("route-finder.reportMoveToChat.hint"),scope:"world",config:!0,default:!0,type:Boolean}),game.settings.register("route-finder","friendlyBlocksFriendly",{name:game.i18n.localize("route-finder.friendlyBlocksFriendly.name"),hint:game.i18n.localize("route-finder.friendlyBlocksFriendly.hint"),scope:"world",config:!0,default:!1,type:Boolean}),game.settings.register("route-finder","friendlyBlocksNeutral",{name:game.i18n.localize("route-finder.friendlyBlocksNeutral.name"),hint:game.i18n.localize("route-finder.friendlyBlocksNeutral.hint"),scope:"world",config:!0,default:!1,type:Boolean}),game.settings.register("route-finder","friendlyBlocksHostile",{name:game.i18n.localize("route-finder.friendlyBlocksHostile.name"),hint:game.i18n.localize("route-finder.friendlyBlocksHostile.hint"),scope:"world",config:!0,default:!0,type:Boolean}),game.settings.register("route-finder","neutralBlocksFriendly",{name:game.i18n.localize("route-finder.neutralBlocksFriendly.name"),hint:game.i18n.localize("route-finder.neutralBlocksFriendly.hint"),scope:"world",config:!0,default:!1,type:Boolean}),game.settings.register("route-finder","neutralBlocksNeutral",{name:game.i18n.localize("route-finder.neutralBlocksNeutral.name"),hint:game.i18n.localize("route-finder.neutralBlocksNeutral.hint"),scope:"world",config:!0,default:!1,type:Boolean}),game.settings.register("route-finder","neutralBlocksHostile",{name:game.i18n.localize("route-finder.neutralBlocksHostile.name"),hint:game.i18n.localize("route-finder.neutralBlocksHostile.hint"),scope:"world",config:!0,default:!1,type:Boolean}),game.settings.register("route-finder","hostileBlocksFriendly",{name:game.i18n.localize("route-finder.hostileBlocksFriendly.name"),hint:game.i18n.localize("route-finder.hostileBlocksFriendly.hint"),scope:"world",config:!0,default:!0,type:Boolean}),game.settings.register("route-finder","hostileBlocksNeutral",{name:game.i18n.localize("route-finder.hostileBlocksNeutral.name"),hint:game.i18n.localize("route-finder.hostileBlocksNeutral.hint"),scope:"world",config:!0,default:!1,type:Boolean}),game.settings.register("route-finder","hostileBlocksHostile",{name:game.i18n.localize("route-finder.hostileBlocksHostile.name"),hint:game.i18n.localize("route-finder.hostileBlocksHostile.hint"),scope:"world",config:!0,default:!1,type:Boolean})};function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var f=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=new g,this.moveQueue=new s.a(1,1/0),this.deleteQueue=new s.a(1,1/0),this.walkable,this.messageDialog,this.lastPath,this.countdown,Hooks.on("canvasReady",(function(){e.walkable=new c,e.deleteAllOwnRoutes(),canvas.stage.on("mousemove",(function(t){return e.mousemoveListener(t)})),canvas.stage.on("rightup",(function(t){return e.rightupListener(t)})),game.modules.get("pathfinding")&&game.modules.get("pathfinding").active&&e.displayMessage(game.i18n.localize("route-finder.errors.oldNameFound"))})),Hooks.on("createWall",(function(t,n,i){e.walkable.addWall(i)})),Hooks.on("updateWall",(function(t,n,i,s){var r=s.currentData;i.hasOwnProperty("ds")?(r.ds=i.ds,1===r.ds?e.walkable.deleteWallById(r._id):e.walkable.addWall(r)):i.hasOwnProperty("c")&&(r.c=i.c,e.walkable.deleteWallById(r._id),e.walkable.addWall(r))})),Hooks.on("deleteWall",(function(t,n,i){e.walkable.deleteWallById(i)})),Hooks.on("controlToken",(function(t,n){if(e.walkable)if(n){var i={"-1":{"-1":game.settings.get("route-finder","hostileBlocksHostile"),0:game.settings.get("route-finder","hostileBlocksNeutral"),1:game.settings.get("route-finder","hostileBlocksFriendly")},0:{"-1":game.settings.get("route-finder","neutralBlocksHostile"),0:game.settings.get("route-finder","neutralBlocksNeutral"),1:game.settings.get("route-finder","neutralBlocksFriendly")},1:{"-1":game.settings.get("route-finder","friendlyBlocksHostile"),0:game.settings.get("route-finder","friendlyBlocksNeutral"),1:game.settings.get("route-finder","friendlyBlocksFriendly")}};e.walkable.updateBlockingTokens(t,i)}else e.deleteAllOwnRoutes()})),Hooks.on("getSceneControlButtons",(function(t){var n=t.find((function(t){return"token"===t.name}));n&&n.tools.push({name:"route-finder",title:"Route Finder",icon:"fas fa-route",visible:!0,onClick:function(){1===canvas.tokens.controlledTokens.length?game.paused&&e.displayMessage(game.i18n.localize("route-finder.errors.gamePaused")):canvas.tokens.controlledTokens.length>1?e.displayMessage(game.i18n.localize("route-finder.errors.tooManyTokens")):e.displayMessage(game.i18n.localize("route-finder.errors.tooFewTokens"))}})})),Hooks.on("renderSceneControls",(function(){"route-finder"!==game.activeTool&&setTimeout((function(){e.deleteAllOwnRoutes()}),100)}))}var e,n,i;return e=t,(n=[{key:"moveTokenToWaypoint",value:function(t,e){return this.moveQueue.add((function(){return new Promise((function(n){if(t){var i=e[0]-t.width/2,s=e[1]-t.width/2,r=!1;setTimeout((function(){r||n()}),3e3),t?t.setPosition(i,s).then((function(){t.update({x:i,y:s}).then((function(){setTimeout((function(){r=!0,n()}),20)}))})):(r=!0,n())}else n()}))}))}},{key:"displayMessage",value:function(t){var e=this;this.messageDialog&&this.messageDialog.rendered||(this.messageDialog=new Dialog({title:"Route Finding",content:"<p>".concat(t,"</p>"),buttons:{dismiss:{icon:'<i class="fas fa-times"></i>',label:"Close",callback:function(){e.messageDialog=null}}},close:function(){e.messageDialog=null}},{width:300}).render(!0))}},{key:"deleteDrawingById",value:function(t){return this.deleteQueue.add((function(){return new Promise((function(e){var n=!1;canvas.drawings.placeables.forEach((function(i){i.id===t&&(n=!0,canvas.scene.deleteEmbeddedEntity("Drawing",t).finally((function(){e()})))})),n||e()}))}))}},{key:"deleteAllOwnRoutes",value:function(){return this.deleteQueue.add((function(){var t=[];return canvas.drawings.placeables.forEach((function(e){e.author.isSelf&&e.data.flags.length>0&&e.data.flags.includes("routeFinderPath")&&t.push(e.id)})),canvas.scene.deleteEmbeddedEntity("Drawing",t)}))}},{key:"mousemoveListener",value:function(t){var e=this;game.paused||"route-finder"!==game.activeTool||0!==this.moveQueue.getPendingLength()||0!==this.moveQueue.getQueueLength()||(this.countdown&&clearTimeout(this.countdown),this.countdown=setTimeout((function(){var n=canvas.tokens.controlledTokens[0];if(n){var i=e.walkable.findPath(n.center.x,n.center.y,t.data.destination.x,t.data.destination.y,n.width/3,game.settings.get("route-finder","snapToGrid"));e.deleteAllOwnRoutes().then((function(){e.walkable.drawPath(i,n).then((function(t){e.lastPath=i}))}))}}),100))}},{key:"rightupListener",value:function(t){var e=this;if(this.lastPath&&this.lastPath.length>0&&!game.paused&&"route-finder"===game.activeTool&&0===this.moveQueue.getPendingLength()&&0===this.moveQueue.getQueueLength()){var n=canvas.tokens.controlledTokens[0],i=[];this.walkable.convertToWaypoints(this.lastPath).forEach((function(t){i.push(e.moveTokenToWaypoint(n,t))})),Promise.all(i).then((function(){e.deleteAllOwnRoutes().then((function(){if(game.settings.get("route-finder","reportMoveToChat")){var t={content:"Moved: <b>".concat(e.walkable.calculateDistance(e.lastPath)+game.scenes.viewed.data.gridUnits,"</b>"),type:CONST.CHAT_MESSAGE_TYPES.OTHER,speaker:ChatMessage.getSpeaker({user:game.user})};n.data.hidden&&(t.whisper=ChatMessage.getWhisperRecipients("GM")),ChatMessage.create(t)}e.lastPath=null}))}))}}}])&&l(e.prototype,n),i&&l(e,i),t}();Hooks.on("init",(function(){new f}))}]);